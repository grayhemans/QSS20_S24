{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Problem Set 2: Merging and regular expressions\n",
    "\n",
    "**Total points (without extra credit)**: 30 \n",
    "\n",
    "**Background on the policy context**: here, we're going to use two datasets to practice reshaping, merging, and regular expression patterns. Both datasets relate to the broader issue of which employers might be violating the rights of temporary guestworkers granted visas under the H-2A program. Here are some articles about potential exploitation of guestworkers by firms and inequality caused by minimal oversight:\n",
    "\n",
    "- News media coverage of labor abuses of temporary guestworkers: https://www.buzzfeednews.com/article/kenbensinger/the-pushovers \n",
    "- GAO report on labor abuses of temporary guestworkers: https://www.gao.gov/products/gao-15-154\n",
    "\n",
    "The following datasets are located in `pset2_inputdata` (need to unzip): \n",
    "\n",
    "- `jobs_clean`: a dataset of guestworker jobs posted by many employers, some of whom have been debarred (banned) from the program for labor abuses; others not debarred\n",
    "- `debar`: a dataset of employers who committed violations of labor regulations meant to protect temporary guestworkers \n",
    "\n",
    "\n",
    "You can view a codebook here: https://docs.google.com/spreadsheets/d/1rF9GJEC8pPKxipD0TsoG9DVdqz3EJ-b-BHEtyioAX7I/edit?usp=sharing\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "## helpful packages\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import random\n",
    "import re\n",
    "import os\n",
    "\n",
    "## repeated printouts\n",
    "from IPython.core.interactiveshell import InteractiveShell\n",
    "InteractiveShell.ast_node_interactivity = \"all\"\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 1. Reshaping data (13 points total)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Load the following dataset stored in `pset2_inputdata`: `debar.csv`\n",
    "\n",
    "This represents employers temporarily banned from hiring workers (debar.csv); call this `debar`\n",
    "\n",
    "\n",
    "View the head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>Violation</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Start date</th>\n",
       "      <th>End date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>J&amp;J Harvesting</td>\n",
       "      <td>Leads, ND</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>1/19/2014</td>\n",
       "      <td>1/18/2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Stahlman Apiaries, Inc</td>\n",
       "      <td>Selby, SD</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>2/19/2015</td>\n",
       "      <td>2/14/2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Trust Nursery</td>\n",
       "      <td>Pulaski, NY</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>3/21/2014</td>\n",
       "      <td>3/20/2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Anton Fertilizer Inc.</td>\n",
       "      <td>Dighton, KS</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>3/30/2014</td>\n",
       "      <td>3/29/2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Great Plains Fluid Service, Inc.</td>\n",
       "      <td>Greensburg, KS</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>3/30/2014</td>\n",
       "      <td>3/29/2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>109</th>\n",
       "      <td>Dove Creek Farms</td>\n",
       "      <td>Mount Vernon, TX</td>\n",
       "      <td>Failure to Respond to Audit Request</td>\n",
       "      <td>2 years</td>\n",
       "      <td>2/9/2018</td>\n",
       "      <td>2/8/2020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>110</th>\n",
       "      <td>Jesus Ledesma</td>\n",
       "      <td>Mulberry, FL</td>\n",
       "      <td>Failure to Respond to Audit Request</td>\n",
       "      <td>2 years</td>\n",
       "      <td>2/8/18</td>\n",
       "      <td>2/8/20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>111</th>\n",
       "      <td>Turner Farms</td>\n",
       "      <td>Healy, KS</td>\n",
       "      <td>Failure to comply with the employer's obligati...</td>\n",
       "      <td>7 months</td>\n",
       "      <td>7/17/19</td>\n",
       "      <td>2/10/20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112</th>\n",
       "      <td>B &amp; R Harvesting and Paul Cruz (individual)</td>\n",
       "      <td>Collins, Georgia</td>\n",
       "      <td>WHD Debarment</td>\n",
       "      <td>3 years</td>\n",
       "      <td>4/9/17</td>\n",
       "      <td>4/9/20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>113</th>\n",
       "      <td>Delia Rojas</td>\n",
       "      <td>Lyons, Georgia</td>\n",
       "      <td>WHD Debarment</td>\n",
       "      <td>3 years</td>\n",
       "      <td>4/14/17</td>\n",
       "      <td>4/14/20</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>114 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                            Name       City, State  \\\n",
       "0                                 J&J Harvesting         Leads, ND   \n",
       "1                         Stahlman Apiaries, Inc         Selby, SD   \n",
       "2                                  Trust Nursery       Pulaski, NY   \n",
       "3                          Anton Fertilizer Inc.       Dighton, KS   \n",
       "4               Great Plains Fluid Service, Inc.    Greensburg, KS   \n",
       "..                                           ...               ...   \n",
       "109                             Dove Creek Farms  Mount Vernon, TX   \n",
       "110                                Jesus Ledesma      Mulberry, FL   \n",
       "111                                 Turner Farms         Healy, KS   \n",
       "112  B & R Harvesting and Paul Cruz (individual)  Collins, Georgia   \n",
       "113                                  Delia Rojas    Lyons, Georgia   \n",
       "\n",
       "                                             Violation  Duration Start date  \\\n",
       "0       Failure to respond to audit (partial response)   2 years  1/19/2014   \n",
       "1       Failure to respond to audit (partial response)    1 year  2/19/2015   \n",
       "2       Failure to respond to audit (partial response)    1 year  3/21/2014   \n",
       "3            Failure to respond to audit (no response)   2 years  3/30/2014   \n",
       "4            Failure to respond to audit (no response)   2 years  3/30/2014   \n",
       "..                                                 ...       ...        ...   \n",
       "109                Failure to Respond to Audit Request   2 years   2/9/2018   \n",
       "110                Failure to Respond to Audit Request   2 years     2/8/18   \n",
       "111  Failure to comply with the employer's obligati...  7 months    7/17/19   \n",
       "112                                      WHD Debarment   3 years     4/9/17   \n",
       "113                                      WHD Debarment   3 years    4/14/17   \n",
       "\n",
       "      End date  \n",
       "0    1/18/2016  \n",
       "1    2/14/2016  \n",
       "2    3/20/2015  \n",
       "3    3/29/2016  \n",
       "4    3/29/2016  \n",
       "..         ...  \n",
       "109   2/8/2020  \n",
       "110     2/8/20  \n",
       "111    2/10/20  \n",
       "112     4/9/20  \n",
       "113    4/14/20  \n",
       "\n",
       "[114 rows x 6 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>Violation</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Start date</th>\n",
       "      <th>End date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>J&amp;J Harvesting</td>\n",
       "      <td>Leads, ND</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>1/19/2014</td>\n",
       "      <td>1/18/2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Stahlman Apiaries, Inc</td>\n",
       "      <td>Selby, SD</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>2/19/2015</td>\n",
       "      <td>2/14/2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Trust Nursery</td>\n",
       "      <td>Pulaski, NY</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>3/21/2014</td>\n",
       "      <td>3/20/2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Anton Fertilizer Inc.</td>\n",
       "      <td>Dighton, KS</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>3/30/2014</td>\n",
       "      <td>3/29/2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Great Plains Fluid Service, Inc.</td>\n",
       "      <td>Greensburg, KS</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>3/30/2014</td>\n",
       "      <td>3/29/2016</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                               Name     City, State  \\\n",
       "0                    J&J Harvesting       Leads, ND   \n",
       "1            Stahlman Apiaries, Inc       Selby, SD   \n",
       "2                     Trust Nursery     Pulaski, NY   \n",
       "3             Anton Fertilizer Inc.     Dighton, KS   \n",
       "4  Great Plains Fluid Service, Inc.  Greensburg, KS   \n",
       "\n",
       "                                        Violation Duration Start date  \\\n",
       "0  Failure to respond to audit (partial response)  2 years  1/19/2014   \n",
       "1  Failure to respond to audit (partial response)   1 year  2/19/2015   \n",
       "2  Failure to respond to audit (partial response)   1 year  3/21/2014   \n",
       "3       Failure to respond to audit (no response)  2 years  3/30/2014   \n",
       "4       Failure to respond to audit (no response)  2 years  3/30/2014   \n",
       "\n",
       "    End date  \n",
       "0  1/18/2016  \n",
       "1  2/14/2016  \n",
       "2  3/20/2015  \n",
       "3  3/29/2016  \n",
       "4  3/29/2016  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "debar = pd.read_csv(\"debar.csv\")\n",
    "\n",
    "debar\n",
    "debar.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.1 (1 point)\n",
    "\n",
    "Print the number of rows in `debar` versus the number of unique employer names (`Name`). Is there one row per employer or multiple rows for some employers?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "114"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "98"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_rows = len(debar) \n",
    "\n",
    "num_unique_employers = debar[\"Name\"].nunique()\n",
    "\n",
    "num_rows \n",
    "num_unique_employers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Is there one row per employer or multiple rows for some employers? There are multiple rows for some employers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.2 Investigating duplicated rows (2 points)\n",
    "\n",
    "A. Create a new column in `debar`--`is_repeated`-- that tells us whether an employer (`Name`) is repeated > 1 times\n",
    "\n",
    "*Hint*: there are multiple ways to solve this but some possibilities to get the list of names that are repeated are:\n",
    "- Using value_counts() on the `Name` variable and extracting the index from that value counts \n",
    "- Using groupby to count the rows attached to one name\n",
    "\n",
    "B. Print the rows where `is_repeated == True` and interpret\n",
    "\n",
    "C. Subset to the rows where `is_repeated == True` and save that data as `mult_debar`. Print the head() and shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>Violation</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Start date</th>\n",
       "      <th>End date</th>\n",
       "      <th>is_repeated</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Annabella Land &amp; Cattle</td>\n",
       "      <td>Annabella, UT</td>\n",
       "      <td>Non Payment</td>\n",
       "      <td>1 year</td>\n",
       "      <td>5/9/2014</td>\n",
       "      <td>5/9/2015</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Autumn Hill Orchard</td>\n",
       "      <td>Groton, MA</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/6/2014</td>\n",
       "      <td>7/5/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Caddo Creek Ranch, dba Paradise Ranch</td>\n",
       "      <td>Caddo, TX</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/20/2014</td>\n",
       "      <td>7/19/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Loewen Harvesting LLC</td>\n",
       "      <td>Brownsville, TX</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>8/20/2014</td>\n",
       "      <td>8/19/2015</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Rollo Farm Labor Contractor</td>\n",
       "      <td>Miami, FL</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>8/23/2014</td>\n",
       "      <td>8/22/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Sharon Mathis</td>\n",
       "      <td>Tifton, GA</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>11/16/2014</td>\n",
       "      <td>11/15/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>SRT Farms</td>\n",
       "      <td>Morton, TX</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>11/16/2014</td>\n",
       "      <td>11/15/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Mark Duncan</td>\n",
       "      <td>Roosevelt, UT</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>11/16/2014</td>\n",
       "      <td>11/15/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Maple Ridge Custom Services, LLC</td>\n",
       "      <td>Altheimer, AK</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>11/16/2014</td>\n",
       "      <td>11/15/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>F&amp;W Farms</td>\n",
       "      <td>Ingalls, KS</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>12/10/2014</td>\n",
       "      <td>12/9/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Cisco Produce Inc.</td>\n",
       "      <td>Cairo, GA</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>12/10/2014</td>\n",
       "      <td>12/9/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Old Tree Farms/Verpaalen Custom Service</td>\n",
       "      <td>Volga, SD</td>\n",
       "      <td>WHD Debarment</td>\n",
       "      <td>3 years</td>\n",
       "      <td>12/11/2014</td>\n",
       "      <td>12/10/2017</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Rollo Farm Labor Contractor</td>\n",
       "      <td>Miami, FL</td>\n",
       "      <td>Impeding the Audit Process – Non- Response</td>\n",
       "      <td>2 years</td>\n",
       "      <td>8/23/2014</td>\n",
       "      <td>8/22/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Loewen Harvesting LLC</td>\n",
       "      <td>Brownfield, TX</td>\n",
       "      <td>Impeding the Audit Process – Partial- Response</td>\n",
       "      <td>1 year</td>\n",
       "      <td>8/20/2014</td>\n",
       "      <td>8/19/2015</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Caddo Creek Ranch, dba Paradise Ranch</td>\n",
       "      <td>Caddo, Texas</td>\n",
       "      <td>Impeding the Audit Process – Partial- Response</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/20/2014</td>\n",
       "      <td>7/19/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Autumn Hill Orchard</td>\n",
       "      <td>Groton, MA</td>\n",
       "      <td>Impeding the Audit Process – Non- Response</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/6/2014</td>\n",
       "      <td>7/5/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>Annabella Land &amp; Cattle</td>\n",
       "      <td>Annabella, Utah</td>\n",
       "      <td>Non-payment</td>\n",
       "      <td>1 year</td>\n",
       "      <td>5/9/2014</td>\n",
       "      <td>5/8/2015</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>Macky and Brad Farms</td>\n",
       "      <td>Plains, TX</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>2/13/2015</td>\n",
       "      <td>2/12/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>Old Tree Farms/Verpaalen Custom Service</td>\n",
       "      <td>Volga, SD</td>\n",
       "      <td>Wage Hour Debarment</td>\n",
       "      <td>3 years</td>\n",
       "      <td>12/1/2014</td>\n",
       "      <td>12/1/2017</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>Macky and Brad Farms</td>\n",
       "      <td>Plains, TX</td>\n",
       "      <td>Impeding the Audit Process – Partial- Response</td>\n",
       "      <td>1 year</td>\n",
       "      <td>2/13/2015</td>\n",
       "      <td>2/12/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>Cisco Produce Inc.</td>\n",
       "      <td>Cairo, GA</td>\n",
       "      <td>Impeding the Audit Process – Non- Response</td>\n",
       "      <td>2 years</td>\n",
       "      <td>12/10/2015</td>\n",
       "      <td>12/9/2017</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>F&amp;W Farms</td>\n",
       "      <td>Ingalls, KS</td>\n",
       "      <td>Impeding the Audit Process – Partial- Response</td>\n",
       "      <td>1 year</td>\n",
       "      <td>12/10/2014</td>\n",
       "      <td>12/9/2015</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59</th>\n",
       "      <td>Maple Ridge Custom Services, LLC</td>\n",
       "      <td>Altheimer, AR</td>\n",
       "      <td>Impeding the Audit Process – Partial- Response</td>\n",
       "      <td>1 year</td>\n",
       "      <td>11/16/2014</td>\n",
       "      <td>11/15/2015</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>Mark Duncan</td>\n",
       "      <td>Roosevelt, UT</td>\n",
       "      <td>Impeding the Audit Process – Non- Response</td>\n",
       "      <td>2 years</td>\n",
       "      <td>11/16/2014</td>\n",
       "      <td>11/15/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>SRT Farms</td>\n",
       "      <td>Morton, TX</td>\n",
       "      <td>Impeding the Audit Process – Non- Response</td>\n",
       "      <td>2 years</td>\n",
       "      <td>11/16/2014</td>\n",
       "      <td>11/15/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62</th>\n",
       "      <td>Sharon Mathis</td>\n",
       "      <td>Tifton, GA</td>\n",
       "      <td>Impeding the Audit Process – Non- Response</td>\n",
       "      <td>2 years</td>\n",
       "      <td>11/16/2014</td>\n",
       "      <td>11/15/2016</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73</th>\n",
       "      <td>Xavier Horne</td>\n",
       "      <td>Lyons, Georgia</td>\n",
       "      <td>Non-payment of certification fee</td>\n",
       "      <td>1 year</td>\n",
       "      <td>6/16/2016</td>\n",
       "      <td>6/15/2017</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>Xavier Horne</td>\n",
       "      <td>Lyons, Georgia</td>\n",
       "      <td>Failure to respond to audit request</td>\n",
       "      <td>2 years</td>\n",
       "      <td>9/27/2017</td>\n",
       "      <td>9/26/2019</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103</th>\n",
       "      <td>Dove Creek Farms</td>\n",
       "      <td>Mount Vernon, TX</td>\n",
       "      <td>Failure to respond to audit request</td>\n",
       "      <td>2 years</td>\n",
       "      <td>2/9/2018</td>\n",
       "      <td>2/8/2018</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>106</th>\n",
       "      <td>Turner Farms</td>\n",
       "      <td>Healy, KS</td>\n",
       "      <td>Failure to comply with the employer's obligati...</td>\n",
       "      <td>6 months</td>\n",
       "      <td>7/17/19</td>\n",
       "      <td>2/10/2020</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>109</th>\n",
       "      <td>Dove Creek Farms</td>\n",
       "      <td>Mount Vernon, TX</td>\n",
       "      <td>Failure to Respond to Audit Request</td>\n",
       "      <td>2 years</td>\n",
       "      <td>2/9/2018</td>\n",
       "      <td>2/8/2020</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>111</th>\n",
       "      <td>Turner Farms</td>\n",
       "      <td>Healy, KS</td>\n",
       "      <td>Failure to comply with the employer's obligati...</td>\n",
       "      <td>7 months</td>\n",
       "      <td>7/17/19</td>\n",
       "      <td>2/10/20</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                        Name       City, State  \\\n",
       "6                    Annabella Land & Cattle     Annabella, UT   \n",
       "7                        Autumn Hill Orchard        Groton, MA   \n",
       "8      Caddo Creek Ranch, dba Paradise Ranch         Caddo, TX   \n",
       "11                     Loewen Harvesting LLC   Brownsville, TX   \n",
       "12               Rollo Farm Labor Contractor         Miami, FL   \n",
       "14                             Sharon Mathis        Tifton, GA   \n",
       "15                                 SRT Farms        Morton, TX   \n",
       "16                               Mark Duncan     Roosevelt, UT   \n",
       "17          Maple Ridge Custom Services, LLC     Altheimer, AK   \n",
       "18                                 F&W Farms       Ingalls, KS   \n",
       "19                        Cisco Produce Inc.         Cairo, GA   \n",
       "21   Old Tree Farms/Verpaalen Custom Service         Volga, SD   \n",
       "24               Rollo Farm Labor Contractor         Miami, FL   \n",
       "25                     Loewen Harvesting LLC    Brownfield, TX   \n",
       "28     Caddo Creek Ranch, dba Paradise Ranch      Caddo, Texas   \n",
       "29                       Autumn Hill Orchard        Groton, MA   \n",
       "30                   Annabella Land & Cattle   Annabella, Utah   \n",
       "31                      Macky and Brad Farms        Plains, TX   \n",
       "51   Old Tree Farms/Verpaalen Custom Service         Volga, SD   \n",
       "55                      Macky and Brad Farms        Plains, TX   \n",
       "56                        Cisco Produce Inc.         Cairo, GA   \n",
       "58                                 F&W Farms       Ingalls, KS   \n",
       "59          Maple Ridge Custom Services, LLC     Altheimer, AR   \n",
       "60                               Mark Duncan     Roosevelt, UT   \n",
       "61                                 SRT Farms        Morton, TX   \n",
       "62                             Sharon Mathis        Tifton, GA   \n",
       "73                              Xavier Horne    Lyons, Georgia   \n",
       "89                              Xavier Horne    Lyons, Georgia   \n",
       "103                         Dove Creek Farms  Mount Vernon, TX   \n",
       "106                             Turner Farms         Healy, KS   \n",
       "109                         Dove Creek Farms  Mount Vernon, TX   \n",
       "111                             Turner Farms         Healy, KS   \n",
       "\n",
       "                                             Violation  Duration  Start date  \\\n",
       "6                                          Non Payment    1 year    5/9/2014   \n",
       "7            Failure to respond to audit (no response)   2 years    7/6/2014   \n",
       "8       Failure to respond to audit (partial response)   2 years   7/20/2014   \n",
       "11      Failure to respond to audit (partial response)    1 year   8/20/2014   \n",
       "12           Failure to respond to audit (no response)   2 years   8/23/2014   \n",
       "14           Failure to respond to audit (no response)   2 years  11/16/2014   \n",
       "15           Failure to respond to audit (no response)   2 years  11/16/2014   \n",
       "16           Failure to respond to audit (no response)   2 years  11/16/2014   \n",
       "17      Failure to respond to audit (partial response)   2 years  11/16/2014   \n",
       "18      Failure to respond to audit (partial response)   2 years  12/10/2014   \n",
       "19           Failure to respond to audit (no response)   2 years  12/10/2014   \n",
       "21                                       WHD Debarment   3 years  12/11/2014   \n",
       "24          Impeding the Audit Process – Non- Response   2 years   8/23/2014   \n",
       "25      Impeding the Audit Process – Partial- Response    1 year   8/20/2014   \n",
       "28      Impeding the Audit Process – Partial- Response   2 years   7/20/2014   \n",
       "29          Impeding the Audit Process – Non- Response   2 years    7/6/2014   \n",
       "30                                         Non-payment    1 year    5/9/2014   \n",
       "31           Failure to respond to audit (no response)    1 year   2/13/2015   \n",
       "51                                 Wage Hour Debarment   3 years   12/1/2014   \n",
       "55      Impeding the Audit Process – Partial- Response    1 year   2/13/2015   \n",
       "56          Impeding the Audit Process – Non- Response   2 years  12/10/2015   \n",
       "58      Impeding the Audit Process – Partial- Response    1 year  12/10/2014   \n",
       "59      Impeding the Audit Process – Partial- Response    1 year  11/16/2014   \n",
       "60          Impeding the Audit Process – Non- Response   2 years  11/16/2014   \n",
       "61          Impeding the Audit Process – Non- Response   2 years  11/16/2014   \n",
       "62          Impeding the Audit Process – Non- Response   2 years  11/16/2014   \n",
       "73                    Non-payment of certification fee    1 year   6/16/2016   \n",
       "89                 Failure to respond to audit request   2 years   9/27/2017   \n",
       "103                Failure to respond to audit request   2 years    2/9/2018   \n",
       "106  Failure to comply with the employer's obligati...  6 months     7/17/19   \n",
       "109                Failure to Respond to Audit Request   2 years    2/9/2018   \n",
       "111  Failure to comply with the employer's obligati...  7 months     7/17/19   \n",
       "\n",
       "       End date  is_repeated  \n",
       "6      5/9/2015         True  \n",
       "7      7/5/2016         True  \n",
       "8     7/19/2016         True  \n",
       "11    8/19/2015         True  \n",
       "12    8/22/2016         True  \n",
       "14   11/15/2016         True  \n",
       "15   11/15/2016         True  \n",
       "16   11/15/2016         True  \n",
       "17   11/15/2016         True  \n",
       "18    12/9/2016         True  \n",
       "19    12/9/2016         True  \n",
       "21   12/10/2017         True  \n",
       "24    8/22/2016         True  \n",
       "25    8/19/2015         True  \n",
       "28    7/19/2016         True  \n",
       "29     7/5/2016         True  \n",
       "30     5/8/2015         True  \n",
       "31    2/12/2016         True  \n",
       "51    12/1/2017         True  \n",
       "55    2/12/2016         True  \n",
       "56    12/9/2017         True  \n",
       "58    12/9/2015         True  \n",
       "59   11/15/2015         True  \n",
       "60   11/15/2016         True  \n",
       "61   11/15/2016         True  \n",
       "62   11/15/2016         True  \n",
       "73    6/15/2017         True  \n",
       "89    9/26/2019         True  \n",
       "103    2/8/2018         True  \n",
       "106   2/10/2020         True  \n",
       "109    2/8/2020         True  \n",
       "111     2/10/20         True  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "(32, 7)"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## Part A\n",
    "num_employers = debar[\"Name\"].value_counts()\n",
    "repeated_employee_list = num_employers[num_employers > 1].index\n",
    "debar[\"is_repeated\"] = debar[\"Name\"].isin(repeated_employee_list)\n",
    "\n",
    "\n",
    "## Part B\n",
    "debar[debar[\"is_repeated\"] == True]\n",
    "#Interpret \n",
    "# Correct typos in City, State\n",
    "debar[\"City, State\"] = debar[\"City, State\"].str.replace(\"Utah\", \"UT\") \\\n",
    "    .str.replace(\"Georgia\", \"GA\") \\\n",
    "    .str.replace(\"Texas\", \"TX\") \\\n",
    "    .str.replace(\"Altheimer, AK\", \"Altheimer, AR\") \\\n",
    "    .str.replace(\"Brownsville, TX\", \"Brownfield, TX\")\n",
    "\n",
    "## Part C\n",
    "mult_debar=debar[debar[\"is_repeated\"] == True]\n",
    "mult_debar.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.3 Reshape mult_debar to wide to begin filtering out duplicates (4 points)\n",
    "\n",
    "You want to separate out two cases:\n",
    "\n",
    "- Cases where the repeat rows for one employer are due to duplicated data \n",
    "- Cases where the repeat rows for one employer represent repeated violations for different issues\n",
    "\n",
    "There are various ways to check duplicates in this data (eg converting `Violation` to lowercase; replacing spelled-out states with two-dig state codes)\n",
    "\n",
    "We're going to use the simple rule of:\n",
    "\n",
    "- A row is a duplicate if, within an employer (defined by Name + City, State), the Start date for each row's violation is the same \n",
    "\n",
    "To begin to check this, reshape `mult_debar` to a wide dataframe (`mult_debar_wide`) with the following columns, treating the `Name` and `City, State` as the index for the pivot:\n",
    "\n",
    "- Name\n",
    "- City, State\n",
    "- start_date_viol1\n",
    "- start_date_viol2\n",
    "\n",
    "Print the head and shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/ss/3094bd1s7k55hnfygclmswz00000gn/T/ipykernel_44052/796773627.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  mult_debar.loc[:, \"violnum\"] = mult_debar.groupby([\"Name\"]).cumcount() + 1\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>violnum</th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>start_date_viol1</th>\n",
       "      <th>start_date_viol2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Annabella Land &amp; Cattle</td>\n",
       "      <td>Annabella, UT</td>\n",
       "      <td>5/9/2014</td>\n",
       "      <td>5/9/2014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Autumn Hill Orchard</td>\n",
       "      <td>Groton, MA</td>\n",
       "      <td>7/6/2014</td>\n",
       "      <td>7/6/2014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Caddo Creek Ranch, dba Paradise Ranch</td>\n",
       "      <td>Caddo, TX</td>\n",
       "      <td>7/20/2014</td>\n",
       "      <td>7/20/2014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Cisco Produce Inc.</td>\n",
       "      <td>Cairo, GA</td>\n",
       "      <td>12/10/2014</td>\n",
       "      <td>12/10/2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Dove Creek Farms</td>\n",
       "      <td>Mount Vernon, TX</td>\n",
       "      <td>2/9/2018</td>\n",
       "      <td>2/9/2018</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "violnum                                   Name       City, State  \\\n",
       "0                      Annabella Land & Cattle     Annabella, UT   \n",
       "1                          Autumn Hill Orchard        Groton, MA   \n",
       "2        Caddo Creek Ranch, dba Paradise Ranch         Caddo, TX   \n",
       "3                           Cisco Produce Inc.         Cairo, GA   \n",
       "4                             Dove Creek Farms  Mount Vernon, TX   \n",
       "\n",
       "violnum start_date_viol1 start_date_viol2  \n",
       "0               5/9/2014         5/9/2014  \n",
       "1               7/6/2014         7/6/2014  \n",
       "2              7/20/2014        7/20/2014  \n",
       "3             12/10/2014       12/10/2015  \n",
       "4               2/9/2018         2/9/2018  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "(16, 4)"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mult_debar.loc[:, \"violnum\"] = mult_debar.groupby([\"Name\"]).cumcount() + 1\n",
    "\n",
    "mult_debar_wide = mult_debar.pivot(index=[\"Name\", \"City, State\"], columns=\"violnum\", values=\"Start date\")\n",
    "\n",
    "# Rename the columns\n",
    "mult_debar_wide = mult_debar_wide.rename(columns={1: \"start_date_viol1\", 2: \"start_date_viol2\"})\n",
    "\n",
    "# Reset the index\n",
    "mult_debar_wide.reset_index(inplace=True)\n",
    "\n",
    "mult_debar_wide.head()\n",
    "mult_debar_wide.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.4 Filter out duplicates from original debar data (6 points)\n",
    "\n",
    "A. Using `mult_debar_wide`, add a column `is_dup` that takes value of True for cases where start_date_viol1 == start_date_viol2 marking the row as a duplicate\n",
    "\n",
    "B. Going back to the original long-format data you loaded at the beginning- `debar`\n",
    "    - For employers where `is_dup == True` as indicated by your wide-format dataframe, only keep `violnum == viol1`\n",
    "    - For all other employers (so is_dup == False and ones we didnt need to check duplicates for), keep all violnum\n",
    "    - Remove the `is_repeated` column from the `debar` data\n",
    "\n",
    "**Hint**: you can complete part B without a for loop; `pd.concat` with axis = 0 (row binding) is one way\n",
    "\n",
    "Call the resulting dataframe `debar_clean` and print the shape and # of unique employer names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(101, 7)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "98"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# PART A\n",
    "\n",
    "mult_debar_wide.loc[:, \"is_dup\"] = mult_debar_wide[\"start_date_viol1\"] == mult_debar_wide[\"start_date_viol2\"]\n",
    "debar[\"violnum\"] = debar.groupby([\"Name\"]).cumcount() + 1\n",
    "\n",
    "# PART B\n",
    "# Merge mult_debar_wide with debar \n",
    "mult_debar_wide_vn = mult_debar_wide.merge(debar, on=[\"Name\", \"City, State\"], how=\"left\")\n",
    "\n",
    "# Filter\n",
    "filtered_employers_df = mult_debar_wide_vn[(mult_debar_wide_vn[\"is_dup\"] == True)]\n",
    "\n",
    "unique_employer_names = filtered_employers_df[\"Name\"].unique()\n",
    "\n",
    "# Filter\n",
    "debar_clean_pt1 = debar[(debar[\"Name\"].isin(unique_employer_names)) & (debar[\"violnum\"] == 1)]\n",
    "debar_clean_pt2 = debar[~debar[\"Name\"].isin(unique_employer_names)]\n",
    "\n",
    "# concatenate\n",
    "debar_clean = pd.concat([debar_clean_pt1, debar_clean_pt2], axis=0)\n",
    "\n",
    "debar_clean = debar_clean.drop(columns=[\"is_repeated\"])\n",
    "debar_clean = debar_clean.drop_duplicates()\n",
    "debar_clean.shape\n",
    "debar_clean['Name'].nunique()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 2. Merging and regex (17 points total)\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.1 Load data on job postings\n",
    "\n",
    "The previous dataset contains a small subset of employers who faced temporary bans due to violations of H-2A program regulations\n",
    "\n",
    "Since most of the bans have expired, we're going to see which of those employers posted new H-2A jobs in the first quarter of 2021 \n",
    "\n",
    "Loading the `jobs_clean.csv` data stored in `pset4_inputdata`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CASE_NUMBER</th>\n",
       "      <th>CASE_STATUS</th>\n",
       "      <th>RECEIVED_DATE</th>\n",
       "      <th>DECISION_DATE</th>\n",
       "      <th>TYPE_OF_EMPLOYER_APPLICATION</th>\n",
       "      <th>H2A_LABOR_CONTRACTOR</th>\n",
       "      <th>NATURE_OF_TEMPORARY_NEED</th>\n",
       "      <th>EMERGENCY_FILING</th>\n",
       "      <th>EMPLOYER_NAME</th>\n",
       "      <th>TRADE_NAME_DBA</th>\n",
       "      <th>...</th>\n",
       "      <th>ADDENDUM_B_HOUSING_ATTACHED</th>\n",
       "      <th>TOTAL_HOUSING_RECORDS</th>\n",
       "      <th>MEALS_PROVIDED</th>\n",
       "      <th>MEALS_CHARGED</th>\n",
       "      <th>MEAL_REIMBURSEMENT_MINIMUM</th>\n",
       "      <th>MEAL_REIMBURSEMENT_MAXIMUM</th>\n",
       "      <th>PHONE_TO_APPLY</th>\n",
       "      <th>EMAIL_TO_APPLY</th>\n",
       "      <th>WEBSITE_TO_APPLY</th>\n",
       "      <th>TOTAL_ADDENDUM_A_RECORDS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H-300-20199-721302</td>\n",
       "      <td>Determination Issued - Withdrawn</td>\n",
       "      <td>2020-07-17 14:50:40.840</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>Y</td>\n",
       "      <td>Fazio Farms Operating Company, LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>Y</td>\n",
       "      <td>12.68</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13607017661</td>\n",
       "      <td>faziofarms@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H-300-20231-773906</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-20 10:38:15.620</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Association - Agent</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Charlie Sunderland</td>\n",
       "      <td>Panter &amp; Sunderland Nursery</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19318083783</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.jobs4tn.gov/vosnet/Default.aspx</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H-300-20231-774123</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-24 15:33:14.340</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Michael Rudebusch</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19369333827</td>\n",
       "      <td>fayethlynpitre@rocketmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H-300-20231-774151</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-21 12:08:09.760</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Lodahl Farms</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>2</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>14069637560</td>\n",
       "      <td>lodahl_kelsey@yahoo.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H-300-20231-774508</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-20 10:17:34.530</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>Y</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Dunson Harvesting, Inc.</td>\n",
       "      <td>Dunson Harvesting, Inc.</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>8</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>18632939888</td>\n",
       "      <td>NaN</td>\n",
       "      <td>www.employflorida.com</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>H-300-20231-775063</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-21 11:36:32.360</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>CUMBERLAND VALLEY NURSERIES INC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19316684153</td>\n",
       "      <td>fruitrus@blomand.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>H-300-20232-777530</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-31 14:14:31.920</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>O'Connor Ranch Lands, LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>14069758415</td>\n",
       "      <td>occranches@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>H-300-20233-780540</td>\n",
       "      <td>Determination Issued - Certification (Expired)</td>\n",
       "      <td>2020-09-04 14:26:00.270</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Association - Joint Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Farm Labor Association for Growers, Inc.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>Y</td>\n",
       "      <td>13.50</td>\n",
       "      <td>13.50</td>\n",
       "      <td>55.0</td>\n",
       "      <td>17605922256</td>\n",
       "      <td>flag@sfcos.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>H-300-20234-782276</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-31 13:12:17.840</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Rksk Farms</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>16513295061</td>\n",
       "      <td>kimmesbauer@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>H-300-20235-782945</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-17 11:04:44.130</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>CY FARMS, LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13377942790</td>\n",
       "      <td>KASCONTRACTOR@BELLSOUTH.NET</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>H-300-20237-783679</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-02 21:18:28.110</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Keller Farms, Inc</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>16183448623</td>\n",
       "      <td>lindsey@kellerfarmsinc.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>H-300-20237-784078</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-01 09:34:25.760</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>Y</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>WORLDWIDE HARVESTING COMPANY LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>18636731797</td>\n",
       "      <td>wwharvestingco@yahoo.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>H-300-20239-789380</td>\n",
       "      <td>Determination Issued - Withdrawn</td>\n",
       "      <td>2020-08-26 16:18:15.070</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>Y</td>\n",
       "      <td>Optimum Agriculture FL LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>2</td>\n",
       "      <td>Y</td>\n",
       "      <td>12.68</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>referrals@maslabor.com</td>\n",
       "      <td>www.dol.ga.gov</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>H-300-20240-791791</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-27 17:38:17.430</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Association - Agent</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Webb Ranch LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13074722105</td>\n",
       "      <td>info@mpaswy.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>H-300-20240-791807</td>\n",
       "      <td>Determination Issued - Certification (Expired)</td>\n",
       "      <td>2020-09-17 18:57:56.030</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>McLain Farms, Inc.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19125268436</td>\n",
       "      <td>kim@mclainfarms.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>H-300-20240-791975</td>\n",
       "      <td>Determination Issued - Certification (Expired)</td>\n",
       "      <td>2020-09-04 11:15:23.080</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Ryan Herrmann</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>16057705446</td>\n",
       "      <td>ryan_herrmann@hotmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>H-300-20240-792373</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-11 19:06:17.230</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>Y</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Harvestco LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>18636591188</td>\n",
       "      <td>harvestcollc@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>H-300-20244-795767</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-16 12:58:58.600</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Bonnie Plants, Inc.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13343911328</td>\n",
       "      <td>dennis.ucles@bonnieplants.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>H-300-20245-799651</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-02 11:17:48.730</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>B &amp; W Quality Growers, Inc.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>33</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>17725711135</td>\n",
       "      <td>NaN</td>\n",
       "      <td>www.employflorida.com</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>H-300-20245-799951</td>\n",
       "      <td>Determination Issued - Denied</td>\n",
       "      <td>2020-09-11 16:44:35.730</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>Y</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Hays Harvesting Inc.</td>\n",
       "      <td>Hays Harvesting Inc.</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>5</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>17724652626</td>\n",
       "      <td>hays_tiffany@bellsouth.net</td>\n",
       "      <td>https://www.employflorida.com</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>H-300-20246-801467</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-08 12:46:22.920</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Robbie DeVillier Farms and Services LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13379456998</td>\n",
       "      <td>mlaurie80@yahoo.com</td>\n",
       "      <td>www.laworks.net</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>H-300-20246-801482</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-03 13:48:26.250</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Sunny South Packing Company</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>4</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>18634941551</td>\n",
       "      <td>NaN</td>\n",
       "      <td>www.employflorida.com</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>H-300-20248-806317</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-08 10:56:26.940</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Poplar Ridge Farms GP</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>18707610368</td>\n",
       "      <td>cullen.todd@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>H-300-20248-806527</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-10 16:55:58.150</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Association - Joint Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>WESTERN RANGE ASSOCIATION</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>12085952226</td>\n",
       "      <td>applicants@westernrange.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>H-300-20248-806974</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-09-08 14:40:34.670</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Association - Joint Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>WESTERN RANGE ASSOCIATION</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>12085952226</td>\n",
       "      <td>applicants@westernrange.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>25 rows × 138 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           CASE_NUMBER                                     CASE_STATUS  \\\n",
       "0   H-300-20199-721302                Determination Issued - Withdrawn   \n",
       "1   H-300-20231-773906            Determination Issued - Certification   \n",
       "2   H-300-20231-774123            Determination Issued - Certification   \n",
       "3   H-300-20231-774151            Determination Issued - Certification   \n",
       "4   H-300-20231-774508            Determination Issued - Certification   \n",
       "5   H-300-20231-775063            Determination Issued - Certification   \n",
       "6   H-300-20232-777530            Determination Issued - Certification   \n",
       "7   H-300-20233-780540  Determination Issued - Certification (Expired)   \n",
       "8   H-300-20234-782276            Determination Issued - Certification   \n",
       "9   H-300-20235-782945            Determination Issued - Certification   \n",
       "10  H-300-20237-783679            Determination Issued - Certification   \n",
       "11  H-300-20237-784078            Determination Issued - Certification   \n",
       "12  H-300-20239-789380                Determination Issued - Withdrawn   \n",
       "13  H-300-20240-791791            Determination Issued - Certification   \n",
       "14  H-300-20240-791807  Determination Issued - Certification (Expired)   \n",
       "15  H-300-20240-791975  Determination Issued - Certification (Expired)   \n",
       "16  H-300-20240-792373            Determination Issued - Certification   \n",
       "17  H-300-20244-795767            Determination Issued - Certification   \n",
       "18  H-300-20245-799651            Determination Issued - Certification   \n",
       "19  H-300-20245-799951                   Determination Issued - Denied   \n",
       "20  H-300-20246-801467            Determination Issued - Certification   \n",
       "21  H-300-20246-801482            Determination Issued - Certification   \n",
       "22  H-300-20248-806317            Determination Issued - Certification   \n",
       "23  H-300-20248-806527            Determination Issued - Certification   \n",
       "24  H-300-20248-806974            Determination Issued - Certification   \n",
       "\n",
       "              RECEIVED_DATE            DECISION_DATE  \\\n",
       "0   2020-07-17 14:50:40.840  2020-10-01 00:00:00.000   \n",
       "1   2020-08-20 10:38:15.620  2020-10-01 00:00:00.000   \n",
       "2   2020-08-24 15:33:14.340  2020-10-01 00:00:00.000   \n",
       "3   2020-08-21 12:08:09.760  2020-10-01 00:00:00.000   \n",
       "4   2020-08-20 10:17:34.530  2020-10-01 00:00:00.000   \n",
       "5   2020-08-21 11:36:32.360  2020-10-01 00:00:00.000   \n",
       "6   2020-08-31 14:14:31.920  2020-10-01 00:00:00.000   \n",
       "7   2020-09-04 14:26:00.270  2020-10-01 00:00:00.000   \n",
       "8   2020-08-31 13:12:17.840  2020-10-01 00:00:00.000   \n",
       "9   2020-09-17 11:04:44.130  2020-10-01 00:00:00.000   \n",
       "10  2020-09-02 21:18:28.110  2020-10-01 00:00:00.000   \n",
       "11  2020-09-01 09:34:25.760  2020-10-01 00:00:00.000   \n",
       "12  2020-08-26 16:18:15.070  2020-10-01 00:00:00.000   \n",
       "13  2020-08-27 17:38:17.430  2020-10-01 00:00:00.000   \n",
       "14  2020-09-17 18:57:56.030  2020-10-01 00:00:00.000   \n",
       "15  2020-09-04 11:15:23.080  2020-10-01 00:00:00.000   \n",
       "16  2020-09-11 19:06:17.230  2020-10-01 00:00:00.000   \n",
       "17  2020-09-16 12:58:58.600  2020-10-01 00:00:00.000   \n",
       "18  2020-09-02 11:17:48.730  2020-10-01 00:00:00.000   \n",
       "19  2020-09-11 16:44:35.730  2020-10-01 00:00:00.000   \n",
       "20  2020-09-08 12:46:22.920  2020-10-01 00:00:00.000   \n",
       "21  2020-09-03 13:48:26.250  2020-10-01 00:00:00.000   \n",
       "22  2020-09-08 10:56:26.940  2020-10-01 00:00:00.000   \n",
       "23  2020-09-10 16:55:58.150  2020-10-01 00:00:00.000   \n",
       "24  2020-09-08 14:40:34.670  2020-10-01 00:00:00.000   \n",
       "\n",
       "    TYPE_OF_EMPLOYER_APPLICATION H2A_LABOR_CONTRACTOR  \\\n",
       "0            Individual Employer                    N   \n",
       "1            Association - Agent                    N   \n",
       "2            Individual Employer                    N   \n",
       "3            Individual Employer                    N   \n",
       "4            Individual Employer                    Y   \n",
       "5            Individual Employer                    N   \n",
       "6            Individual Employer                    N   \n",
       "7   Association - Joint Employer                    N   \n",
       "8            Individual Employer                    N   \n",
       "9            Individual Employer                    N   \n",
       "10           Individual Employer                    N   \n",
       "11           Individual Employer                    Y   \n",
       "12           Individual Employer                    N   \n",
       "13           Association - Agent                    N   \n",
       "14           Individual Employer                    N   \n",
       "15           Individual Employer                    N   \n",
       "16           Individual Employer                    Y   \n",
       "17           Individual Employer                    N   \n",
       "18           Individual Employer                    N   \n",
       "19           Individual Employer                    Y   \n",
       "20           Individual Employer                    N   \n",
       "21           Individual Employer                    N   \n",
       "22           Individual Employer                    N   \n",
       "23  Association - Joint Employer                    N   \n",
       "24  Association - Joint Employer                    N   \n",
       "\n",
       "   NATURE_OF_TEMPORARY_NEED EMERGENCY_FILING  \\\n",
       "0                  Seasonal                Y   \n",
       "1                  Seasonal                N   \n",
       "2                  Seasonal                N   \n",
       "3                  Seasonal                N   \n",
       "4                  Seasonal                N   \n",
       "5                  Seasonal                N   \n",
       "6                  Seasonal                N   \n",
       "7                  Seasonal                N   \n",
       "8                  Seasonal                N   \n",
       "9                  Seasonal                N   \n",
       "10                 Seasonal                N   \n",
       "11                 Seasonal                N   \n",
       "12                 Seasonal                Y   \n",
       "13                 Seasonal                N   \n",
       "14                 Seasonal                N   \n",
       "15                 Seasonal                N   \n",
       "16                 Seasonal                N   \n",
       "17                 Seasonal                N   \n",
       "18                 Seasonal                N   \n",
       "19                 Seasonal                N   \n",
       "20                 Seasonal                N   \n",
       "21                 Seasonal                N   \n",
       "22                 Seasonal                N   \n",
       "23                 Seasonal                N   \n",
       "24                 Seasonal                N   \n",
       "\n",
       "                               EMPLOYER_NAME               TRADE_NAME_DBA  \\\n",
       "0         Fazio Farms Operating Company, LLC                          NaN   \n",
       "1                         Charlie Sunderland  Panter & Sunderland Nursery   \n",
       "2                          Michael Rudebusch                          NaN   \n",
       "3                               Lodahl Farms                          NaN   \n",
       "4                    Dunson Harvesting, Inc.      Dunson Harvesting, Inc.   \n",
       "5            CUMBERLAND VALLEY NURSERIES INC                          NaN   \n",
       "6                  O'Connor Ranch Lands, LLC                          NaN   \n",
       "7   Farm Labor Association for Growers, Inc.                          NaN   \n",
       "8                                 Rksk Farms                          NaN   \n",
       "9                              CY FARMS, LLC                          NaN   \n",
       "10                         Keller Farms, Inc                          NaN   \n",
       "11          WORLDWIDE HARVESTING COMPANY LLC                          NaN   \n",
       "12                Optimum Agriculture FL LLC                          NaN   \n",
       "13                            Webb Ranch LLC                          NaN   \n",
       "14                        McLain Farms, Inc.                          NaN   \n",
       "15                             Ryan Herrmann                          NaN   \n",
       "16                             Harvestco LLC                          NaN   \n",
       "17                       Bonnie Plants, Inc.                          NaN   \n",
       "18               B & W Quality Growers, Inc.                          NaN   \n",
       "19                      Hays Harvesting Inc.         Hays Harvesting Inc.   \n",
       "20   Robbie DeVillier Farms and Services LLC                          NaN   \n",
       "21               Sunny South Packing Company                          NaN   \n",
       "22                     Poplar Ridge Farms GP                          NaN   \n",
       "23                 WESTERN RANGE ASSOCIATION                          NaN   \n",
       "24                 WESTERN RANGE ASSOCIATION                          NaN   \n",
       "\n",
       "    ... ADDENDUM_B_HOUSING_ATTACHED TOTAL_HOUSING_RECORDS MEALS_PROVIDED  \\\n",
       "0   ...                           N                     1              Y   \n",
       "1   ...                           N                     1              N   \n",
       "2   ...                           N                     1              N   \n",
       "3   ...                           Y                     2              N   \n",
       "4   ...                           Y                     8              N   \n",
       "5   ...                           N                     1              N   \n",
       "6   ...                           N                     1              N   \n",
       "7   ...                           N                     1              Y   \n",
       "8   ...                           N                     1              N   \n",
       "9   ...                           N                     1              N   \n",
       "10  ...                           N                     1              N   \n",
       "11  ...                           N                     1              N   \n",
       "12  ...                           Y                     2              Y   \n",
       "13  ...                           N                     1              N   \n",
       "14  ...                           N                     1              N   \n",
       "15  ...                           N                     1              N   \n",
       "16  ...                           N                     1              N   \n",
       "17  ...                           N                     1              N   \n",
       "18  ...                           Y                    33              N   \n",
       "19  ...                           Y                     5              N   \n",
       "20  ...                           N                     1              N   \n",
       "21  ...                           Y                     4              N   \n",
       "22  ...                           N                     1              N   \n",
       "23  ...                           N                     1              N   \n",
       "24  ...                           N                     1              N   \n",
       "\n",
       "   MEALS_CHARGED MEAL_REIMBURSEMENT_MINIMUM MEAL_REIMBURSEMENT_MAXIMUM  \\\n",
       "0          12.68                      12.68                       55.0   \n",
       "1            NaN                      12.68                       55.0   \n",
       "2            NaN                      12.68                       55.0   \n",
       "3            NaN                      12.68                       55.0   \n",
       "4            NaN                      12.68                       55.0   \n",
       "5            NaN                      12.68                       55.0   \n",
       "6            NaN                      12.68                       55.0   \n",
       "7          13.50                      13.50                       55.0   \n",
       "8            NaN                      12.68                       55.0   \n",
       "9            NaN                      12.68                       55.0   \n",
       "10           NaN                      12.68                       55.0   \n",
       "11           NaN                      12.68                       55.0   \n",
       "12         12.68                      12.68                       55.0   \n",
       "13           NaN                      12.68                       55.0   \n",
       "14           NaN                      12.68                       55.0   \n",
       "15           NaN                      12.68                       55.0   \n",
       "16           NaN                      12.68                       55.0   \n",
       "17           NaN                      12.68                       55.0   \n",
       "18           NaN                      12.68                       55.0   \n",
       "19           NaN                      12.68                       55.0   \n",
       "20           NaN                      12.68                       55.0   \n",
       "21           NaN                      12.68                       55.0   \n",
       "22           NaN                      12.68                       55.0   \n",
       "23           NaN                      12.68                       55.0   \n",
       "24           NaN                      12.68                       55.0   \n",
       "\n",
       "   PHONE_TO_APPLY                 EMAIL_TO_APPLY  \\\n",
       "0     13607017661           faziofarms@gmail.com   \n",
       "1     19318083783                            NaN   \n",
       "2     19369333827  fayethlynpitre@rocketmail.com   \n",
       "3     14069637560        lodahl_kelsey@yahoo.com   \n",
       "4     18632939888                            NaN   \n",
       "5     19316684153           fruitrus@blomand.net   \n",
       "6     14069758415           occranches@gmail.com   \n",
       "7     17605922256                 flag@sfcos.com   \n",
       "8     16513295061          kimmesbauer@gmail.com   \n",
       "9     13377942790    KASCONTRACTOR@BELLSOUTH.NET   \n",
       "10    16183448623     lindsey@kellerfarmsinc.com   \n",
       "11    18636731797       wwharvestingco@yahoo.com   \n",
       "12            NaN         referrals@maslabor.com   \n",
       "13    13074722105                info@mpaswy.com   \n",
       "14    19125268436            kim@mclainfarms.com   \n",
       "15    16057705446      ryan_herrmann@hotmail.com   \n",
       "16    18636591188         harvestcollc@gmail.com   \n",
       "17    13343911328  dennis.ucles@bonnieplants.com   \n",
       "18    17725711135                            NaN   \n",
       "19    17724652626     hays_tiffany@bellsouth.net   \n",
       "20    13379456998            mlaurie80@yahoo.com   \n",
       "21    18634941551                            NaN   \n",
       "22    18707610368          cullen.todd@gmail.com   \n",
       "23    12085952226    applicants@westernrange.net   \n",
       "24    12085952226    applicants@westernrange.net   \n",
       "\n",
       "                               WEBSITE_TO_APPLY  TOTAL_ADDENDUM_A_RECORDS  \n",
       "0                                           NaN                         0  \n",
       "1   https://www.jobs4tn.gov/vosnet/Default.aspx                         0  \n",
       "2                                           NaN                         0  \n",
       "3                                           NaN                         0  \n",
       "4                         www.employflorida.com                         4  \n",
       "5                                           NaN                         0  \n",
       "6                                           NaN                         0  \n",
       "7                                           NaN                         9  \n",
       "8                                           NaN                         1  \n",
       "9                                           NaN                         0  \n",
       "10                                          NaN                         0  \n",
       "11                                          NaN                         3  \n",
       "12                               www.dol.ga.gov                         0  \n",
       "13                                          NaN                         0  \n",
       "14                                          NaN                         1  \n",
       "15                                          NaN                         0  \n",
       "16                                          NaN                         2  \n",
       "17                                          NaN                         0  \n",
       "18                        www.employflorida.com                         7  \n",
       "19                https://www.employflorida.com                        17  \n",
       "20                              www.laworks.net                         4  \n",
       "21                        www.employflorida.com                         3  \n",
       "22                                          NaN                         0  \n",
       "23                                          NaN                         0  \n",
       "24                                          NaN                         0  \n",
       "\n",
       "[25 rows x 138 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "jobs = pd.read_csv(\"jobs.csv\")\n",
    "\n",
    "jobs.head(25) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##  2.2 Try inner join on employer name  (2 points)\n",
    "\n",
    "- Use the `EMPLOYER_NAME` field of the `jobs` dataset\n",
    "- Use the `Name` field of the `debar_clean` dataset \n",
    "\n",
    "A. Use pd.merge with an inner join on those fields to see whether there are any exact matches. \n",
    "\n",
    "B. If there are exact matches, print the row(s) with exact matches\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>Violation</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Start date</th>\n",
       "      <th>End date</th>\n",
       "      <th>violnum</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Annabella Land &amp; Cattle</td>\n",
       "      <td>Annabella, UT</td>\n",
       "      <td>Non Payment</td>\n",
       "      <td>1 year</td>\n",
       "      <td>5/9/2014</td>\n",
       "      <td>5/9/2015</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Autumn Hill Orchard</td>\n",
       "      <td>Groton, MA</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/6/2014</td>\n",
       "      <td>7/5/2016</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Caddo Creek Ranch, dba Paradise Ranch</td>\n",
       "      <td>Caddo, TX</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/20/2014</td>\n",
       "      <td>7/19/2016</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Loewen Harvesting LLC</td>\n",
       "      <td>Brownfield, TX</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>8/20/2014</td>\n",
       "      <td>8/19/2015</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Rollo Farm Labor Contractor</td>\n",
       "      <td>Miami, FL</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>8/23/2014</td>\n",
       "      <td>8/22/2016</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     Name     City, State  \\\n",
       "6                 Annabella Land & Cattle   Annabella, UT   \n",
       "7                     Autumn Hill Orchard      Groton, MA   \n",
       "8   Caddo Creek Ranch, dba Paradise Ranch       Caddo, TX   \n",
       "11                  Loewen Harvesting LLC  Brownfield, TX   \n",
       "12            Rollo Farm Labor Contractor       Miami, FL   \n",
       "\n",
       "                                         Violation Duration Start date  \\\n",
       "6                                      Non Payment   1 year   5/9/2014   \n",
       "7        Failure to respond to audit (no response)  2 years   7/6/2014   \n",
       "8   Failure to respond to audit (partial response)  2 years  7/20/2014   \n",
       "11  Failure to respond to audit (partial response)   1 year  8/20/2014   \n",
       "12       Failure to respond to audit (no response)  2 years  8/23/2014   \n",
       "\n",
       "     End date  violnum  \n",
       "6    5/9/2015        1  \n",
       "7    7/5/2016        1  \n",
       "8   7/19/2016        1  \n",
       "11  8/19/2015        1  \n",
       "12  8/22/2016        1  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CASE_NUMBER</th>\n",
       "      <th>CASE_STATUS</th>\n",
       "      <th>RECEIVED_DATE</th>\n",
       "      <th>DECISION_DATE</th>\n",
       "      <th>TYPE_OF_EMPLOYER_APPLICATION</th>\n",
       "      <th>H2A_LABOR_CONTRACTOR</th>\n",
       "      <th>NATURE_OF_TEMPORARY_NEED</th>\n",
       "      <th>EMERGENCY_FILING</th>\n",
       "      <th>EMPLOYER_NAME</th>\n",
       "      <th>TRADE_NAME_DBA</th>\n",
       "      <th>...</th>\n",
       "      <th>ADDENDUM_B_HOUSING_ATTACHED</th>\n",
       "      <th>TOTAL_HOUSING_RECORDS</th>\n",
       "      <th>MEALS_PROVIDED</th>\n",
       "      <th>MEALS_CHARGED</th>\n",
       "      <th>MEAL_REIMBURSEMENT_MINIMUM</th>\n",
       "      <th>MEAL_REIMBURSEMENT_MAXIMUM</th>\n",
       "      <th>PHONE_TO_APPLY</th>\n",
       "      <th>EMAIL_TO_APPLY</th>\n",
       "      <th>WEBSITE_TO_APPLY</th>\n",
       "      <th>TOTAL_ADDENDUM_A_RECORDS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H-300-20199-721302</td>\n",
       "      <td>Determination Issued - Withdrawn</td>\n",
       "      <td>2020-07-17 14:50:40.840</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>Y</td>\n",
       "      <td>Fazio Farms Operating Company, LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>Y</td>\n",
       "      <td>12.68</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13607017661</td>\n",
       "      <td>faziofarms@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H-300-20231-773906</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-20 10:38:15.620</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Association - Agent</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Charlie Sunderland</td>\n",
       "      <td>Panter &amp; Sunderland Nursery</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19318083783</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.jobs4tn.gov/vosnet/Default.aspx</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H-300-20231-774123</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-24 15:33:14.340</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Michael Rudebusch</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>1</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19369333827</td>\n",
       "      <td>fayethlynpitre@rocketmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H-300-20231-774151</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-21 12:08:09.760</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Lodahl Farms</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>2</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>14069637560</td>\n",
       "      <td>lodahl_kelsey@yahoo.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H-300-20231-774508</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-20 10:17:34.530</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>Y</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>Dunson Harvesting, Inc.</td>\n",
       "      <td>Dunson Harvesting, Inc.</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>8</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>18632939888</td>\n",
       "      <td>NaN</td>\n",
       "      <td>www.employflorida.com</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 138 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          CASE_NUMBER                           CASE_STATUS  \\\n",
       "0  H-300-20199-721302      Determination Issued - Withdrawn   \n",
       "1  H-300-20231-773906  Determination Issued - Certification   \n",
       "2  H-300-20231-774123  Determination Issued - Certification   \n",
       "3  H-300-20231-774151  Determination Issued - Certification   \n",
       "4  H-300-20231-774508  Determination Issued - Certification   \n",
       "\n",
       "             RECEIVED_DATE            DECISION_DATE  \\\n",
       "0  2020-07-17 14:50:40.840  2020-10-01 00:00:00.000   \n",
       "1  2020-08-20 10:38:15.620  2020-10-01 00:00:00.000   \n",
       "2  2020-08-24 15:33:14.340  2020-10-01 00:00:00.000   \n",
       "3  2020-08-21 12:08:09.760  2020-10-01 00:00:00.000   \n",
       "4  2020-08-20 10:17:34.530  2020-10-01 00:00:00.000   \n",
       "\n",
       "  TYPE_OF_EMPLOYER_APPLICATION H2A_LABOR_CONTRACTOR NATURE_OF_TEMPORARY_NEED  \\\n",
       "0          Individual Employer                    N                 Seasonal   \n",
       "1          Association - Agent                    N                 Seasonal   \n",
       "2          Individual Employer                    N                 Seasonal   \n",
       "3          Individual Employer                    N                 Seasonal   \n",
       "4          Individual Employer                    Y                 Seasonal   \n",
       "\n",
       "  EMERGENCY_FILING                       EMPLOYER_NAME  \\\n",
       "0                Y  Fazio Farms Operating Company, LLC   \n",
       "1                N                  Charlie Sunderland   \n",
       "2                N                   Michael Rudebusch   \n",
       "3                N                        Lodahl Farms   \n",
       "4                N             Dunson Harvesting, Inc.   \n",
       "\n",
       "                TRADE_NAME_DBA  ... ADDENDUM_B_HOUSING_ATTACHED  \\\n",
       "0                          NaN  ...                           N   \n",
       "1  Panter & Sunderland Nursery  ...                           N   \n",
       "2                          NaN  ...                           N   \n",
       "3                          NaN  ...                           Y   \n",
       "4      Dunson Harvesting, Inc.  ...                           Y   \n",
       "\n",
       "  TOTAL_HOUSING_RECORDS MEALS_PROVIDED MEALS_CHARGED  \\\n",
       "0                     1              Y         12.68   \n",
       "1                     1              N           NaN   \n",
       "2                     1              N           NaN   \n",
       "3                     2              N           NaN   \n",
       "4                     8              N           NaN   \n",
       "\n",
       "  MEAL_REIMBURSEMENT_MINIMUM MEAL_REIMBURSEMENT_MAXIMUM PHONE_TO_APPLY  \\\n",
       "0                      12.68                       55.0    13607017661   \n",
       "1                      12.68                       55.0    19318083783   \n",
       "2                      12.68                       55.0    19369333827   \n",
       "3                      12.68                       55.0    14069637560   \n",
       "4                      12.68                       55.0    18632939888   \n",
       "\n",
       "                  EMAIL_TO_APPLY                             WEBSITE_TO_APPLY  \\\n",
       "0           faziofarms@gmail.com                                          NaN   \n",
       "1                            NaN  https://www.jobs4tn.gov/vosnet/Default.aspx   \n",
       "2  fayethlynpitre@rocketmail.com                                          NaN   \n",
       "3        lodahl_kelsey@yahoo.com                                          NaN   \n",
       "4                            NaN                        www.employflorida.com   \n",
       "\n",
       "   TOTAL_ADDENDUM_A_RECORDS  \n",
       "0                         0  \n",
       "1                         0  \n",
       "2                         0  \n",
       "3                         0  \n",
       "4                         4  \n",
       "\n",
       "[5 rows x 138 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CASE_NUMBER</th>\n",
       "      <th>CASE_STATUS</th>\n",
       "      <th>RECEIVED_DATE</th>\n",
       "      <th>DECISION_DATE</th>\n",
       "      <th>TYPE_OF_EMPLOYER_APPLICATION</th>\n",
       "      <th>H2A_LABOR_CONTRACTOR</th>\n",
       "      <th>NATURE_OF_TEMPORARY_NEED</th>\n",
       "      <th>EMERGENCY_FILING</th>\n",
       "      <th>EMPLOYER_NAME</th>\n",
       "      <th>TRADE_NAME_DBA</th>\n",
       "      <th>...</th>\n",
       "      <th>EMAIL_TO_APPLY</th>\n",
       "      <th>WEBSITE_TO_APPLY</th>\n",
       "      <th>TOTAL_ADDENDUM_A_RECORDS</th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>Violation</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Start date</th>\n",
       "      <th>End date</th>\n",
       "      <th>violnum</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H-300-20287-876656</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-10-20 09:20:32.010</td>\n",
       "      <td>2020-11-09 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>Y</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>Y</td>\n",
       "      <td>Rafael Barajas</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://seasonaljobs.dol.gov/</td>\n",
       "      <td>7</td>\n",
       "      <td>Rafael Barajas</td>\n",
       "      <td>Sebring, Florida</td>\n",
       "      <td>Non-payment of certification fee</td>\n",
       "      <td>1 year</td>\n",
       "      <td>9/23/2016</td>\n",
       "      <td>9/22/2017</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1 rows × 145 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          CASE_NUMBER                           CASE_STATUS  \\\n",
       "0  H-300-20287-876656  Determination Issued - Certification   \n",
       "\n",
       "             RECEIVED_DATE            DECISION_DATE  \\\n",
       "0  2020-10-20 09:20:32.010  2020-11-09 00:00:00.000   \n",
       "\n",
       "  TYPE_OF_EMPLOYER_APPLICATION H2A_LABOR_CONTRACTOR NATURE_OF_TEMPORARY_NEED  \\\n",
       "0          Individual Employer                    Y                 Seasonal   \n",
       "\n",
       "  EMERGENCY_FILING   EMPLOYER_NAME TRADE_NAME_DBA  ... EMAIL_TO_APPLY  \\\n",
       "0                Y  Rafael Barajas            NaN  ...            NaN   \n",
       "\n",
       "                WEBSITE_TO_APPLY TOTAL_ADDENDUM_A_RECORDS            Name  \\\n",
       "0  https://seasonaljobs.dol.gov/                        7  Rafael Barajas   \n",
       "\n",
       "        City, State                         Violation Duration  Start date  \\\n",
       "0  Sebring, Florida  Non-payment of certification fee   1 year   9/23/2016   \n",
       "\n",
       "    End date  violnum  \n",
       "0  9/22/2017        1  \n",
       "\n",
       "[1 rows x 145 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "debar_clean.head()\n",
    "jobs.head()\n",
    "\n",
    "jobs['EMPLOYER_NAME'] = jobs['EMPLOYER_NAME'].astype(str)\n",
    "debar_clean['Name'] = debar_clean['Name'].astype(str)\n",
    "\n",
    "merged_df = jobs.merge(debar_clean, left_on=\"EMPLOYER_NAME\", right_on=\"Name\", how=\"inner\")\n",
    "\n",
    "merged_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.3 Targeted regex (10 points total)\n",
    "\n",
    "You want to see if you can increase the exact match rate with some basic cleaning of each \n",
    "of the employer name fields in each dataset "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.3.1 Converting to upper (2 points)\n",
    "\n",
    "A. Convert the `EMPLOYER_NAME` and `Name` fields to uppercase using list comprehension rather than df.varname.str.upper() (it's fine to do a separate list comprehension line for each of the two columns)\n",
    "\n",
    "B. Print a random sample of 15 values of each result\n",
    "\n",
    "C. Assign the full vector of uppercase names back to the original data, writing over the original `EMPLOYER_NAME` and `Name` columns "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "jobs['EMPLOYER_NAME_UPPERCASE'] = [name.upper() for name in jobs['EMPLOYER_NAME']]\n",
    "debar_clean['Name_Uppercase'] = [name.upper() for name in debar_clean['Name']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1139                  L&M FARMS OF NORTH FLORIDA, LLC\n",
       "762                    HOYT ALTMAN BLUEBERRY FARM LLC\n",
       "384                            SUN BERRY ORCHARD INC.\n",
       "2611                          HOTCHKISS RANCHES, INC.\n",
       "2509                            HEARTLAND FARMS, INC.\n",
       "662     THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.\n",
       "1928                       SHARIDEN FARMS PARTNERSHIP\n",
       "2088                                        JODI HILL\n",
       "2303                          ALLRED LAND & LIVESTOCK\n",
       "2522                                   JOHNDALES FARM\n",
       "1396                        WESTERN RANGE ASSOCIATION\n",
       "1941                                BRB LIVESTOCK INC\n",
       "1008                                  AGRILABOR, INC.\n",
       "2307                                       GOATS R US\n",
       "2670                              MCF4 SOLUTIONS, LLC\n",
       "Name: EMPLOYER_NAME_UPPERCASE, dtype: object"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "20                 SLASH E.V. RANCH LLP\n",
       "64                   GONZALO FERNANDEZ*\n",
       "68              MELVIN DON UNDERWOOD II\n",
       "103                    DOVE CREEK FARMS\n",
       "48                PEACH CREST FARM, LLC\n",
       "104    LOV RANCH CO, LLLP DBA LOV RANCH\n",
       "37                         JOHN R. COOK\n",
       "100                   EVERGREEN PRODUCE\n",
       "93                     DEAL FAMILY FARM\n",
       "35                          IRISH FLATS\n",
       "80                      M KENESTON CORP\n",
       "72         SAXTONS RIVER ORCHARDS, INC.\n",
       "79                         TODD DAULTON\n",
       "7                   AUTUMN HILL ORCHARD\n",
       "63                       RAFAEL BARAJAS\n",
       "Name: Name_Uppercase, dtype: object"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "jobs['EMPLOYER_NAME_UPPERCASE'].sample(n=15)\n",
    "debar_clean['Name_Uppercase'].sample(n=15)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "jobs['EMPLOYER_NAME'] = jobs['EMPLOYER_NAME_UPPERCASE']\n",
    "debar_clean['Name'] = debar_clean['Name_Uppercase']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.3.2 Cleaning up punctuation (4 points)\n",
    "\n",
    "You notice that INC, CO, and LLC are sometimes followed by a period (.) but sometimes not\n",
    "\n",
    "A. For each dataset, write a regex pattern using `re.sub` to remove the . but only if it's preceded by INC, LLC, or CO \n",
    "\n",
    "Make sure LLC, INC, CO remain part of the string but just without the dot\n",
    "\n",
    "B. Test the pattern on the positive and negative example we provide below and print the result. See the Github issue for examples of what to return\n",
    "\n",
    "\n",
    "**Hint**: https://stackoverflow.com/questions/7191209/python-re-sub-replace-with-matched-content\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "pos_example_1 = \"CISCO PRODUCE INC.\"\n",
    "pos_example_2 = \"AVOYELLES HONEY CO., LLC\"\n",
    "neg_example = \"E.V. RANCH LLP\"\n",
    "test_cases = [pos_example_1, pos_example_2, neg_example]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Result for testing with Debar Dataset Regex rule\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>Violation</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Start date</th>\n",
       "      <th>End date</th>\n",
       "      <th>violnum</th>\n",
       "      <th>Name_Uppercase</th>\n",
       "      <th>clean_punctuation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>ANNABELLA LAND &amp; CATTLE</td>\n",
       "      <td>Annabella, UT</td>\n",
       "      <td>Non Payment</td>\n",
       "      <td>1 year</td>\n",
       "      <td>5/9/2014</td>\n",
       "      <td>5/9/2015</td>\n",
       "      <td>1</td>\n",
       "      <td>ANNABELLA LAND &amp; CATTLE</td>\n",
       "      <td>ANNABELLA LAND &amp; CATTLE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>AUTUMN HILL ORCHARD</td>\n",
       "      <td>Groton, MA</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/6/2014</td>\n",
       "      <td>7/5/2016</td>\n",
       "      <td>1</td>\n",
       "      <td>AUTUMN HILL ORCHARD</td>\n",
       "      <td>AUTUMN HILL ORCHARD</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>CADDO CREEK RANCH, DBA PARADISE RANCH</td>\n",
       "      <td>Caddo, TX</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/20/2014</td>\n",
       "      <td>7/19/2016</td>\n",
       "      <td>1</td>\n",
       "      <td>CADDO CREEK RANCH, DBA PARADISE RANCH</td>\n",
       "      <td>CADDO CREEK RANCH, DBA PARADISE RANCH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>LOEWEN HARVESTING LLC</td>\n",
       "      <td>Brownfield, TX</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>8/20/2014</td>\n",
       "      <td>8/19/2015</td>\n",
       "      <td>1</td>\n",
       "      <td>LOEWEN HARVESTING LLC</td>\n",
       "      <td>LOEWEN HARVESTING LLC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>ROLLO FARM LABOR CONTRACTOR</td>\n",
       "      <td>Miami, FL</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>8/23/2014</td>\n",
       "      <td>8/22/2016</td>\n",
       "      <td>1</td>\n",
       "      <td>ROLLO FARM LABOR CONTRACTOR</td>\n",
       "      <td>ROLLO FARM LABOR CONTRACTOR</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     Name     City, State  \\\n",
       "6                 ANNABELLA LAND & CATTLE   Annabella, UT   \n",
       "7                     AUTUMN HILL ORCHARD      Groton, MA   \n",
       "8   CADDO CREEK RANCH, DBA PARADISE RANCH       Caddo, TX   \n",
       "11                  LOEWEN HARVESTING LLC  Brownfield, TX   \n",
       "12            ROLLO FARM LABOR CONTRACTOR       Miami, FL   \n",
       "\n",
       "                                         Violation Duration Start date  \\\n",
       "6                                      Non Payment   1 year   5/9/2014   \n",
       "7        Failure to respond to audit (no response)  2 years   7/6/2014   \n",
       "8   Failure to respond to audit (partial response)  2 years  7/20/2014   \n",
       "11  Failure to respond to audit (partial response)   1 year  8/20/2014   \n",
       "12       Failure to respond to audit (no response)  2 years  8/23/2014   \n",
       "\n",
       "     End date  violnum                         Name_Uppercase  \\\n",
       "6    5/9/2015        1                ANNABELLA LAND & CATTLE   \n",
       "7    7/5/2016        1                    AUTUMN HILL ORCHARD   \n",
       "8   7/19/2016        1  CADDO CREEK RANCH, DBA PARADISE RANCH   \n",
       "11  8/19/2015        1                  LOEWEN HARVESTING LLC   \n",
       "12  8/22/2016        1            ROLLO FARM LABOR CONTRACTOR   \n",
       "\n",
       "                        clean_punctuation  \n",
       "6                 ANNABELLA LAND & CATTLE  \n",
       "7                     AUTUMN HILL ORCHARD  \n",
       "8   CADDO CREEK RANCH, DBA PARADISE RANCH  \n",
       "11                  LOEWEN HARVESTING LLC  \n",
       "12            ROLLO FARM LABOR CONTRACTOR  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Result for testing with Jobs Dataset Regex rule\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CASE_NUMBER</th>\n",
       "      <th>CASE_STATUS</th>\n",
       "      <th>RECEIVED_DATE</th>\n",
       "      <th>DECISION_DATE</th>\n",
       "      <th>TYPE_OF_EMPLOYER_APPLICATION</th>\n",
       "      <th>H2A_LABOR_CONTRACTOR</th>\n",
       "      <th>NATURE_OF_TEMPORARY_NEED</th>\n",
       "      <th>EMERGENCY_FILING</th>\n",
       "      <th>EMPLOYER_NAME</th>\n",
       "      <th>TRADE_NAME_DBA</th>\n",
       "      <th>...</th>\n",
       "      <th>MEALS_PROVIDED</th>\n",
       "      <th>MEALS_CHARGED</th>\n",
       "      <th>MEAL_REIMBURSEMENT_MINIMUM</th>\n",
       "      <th>MEAL_REIMBURSEMENT_MAXIMUM</th>\n",
       "      <th>PHONE_TO_APPLY</th>\n",
       "      <th>EMAIL_TO_APPLY</th>\n",
       "      <th>WEBSITE_TO_APPLY</th>\n",
       "      <th>TOTAL_ADDENDUM_A_RECORDS</th>\n",
       "      <th>EMPLOYER_NAME_UPPERCASE</th>\n",
       "      <th>clean_punctuation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H-300-20199-721302</td>\n",
       "      <td>Determination Issued - Withdrawn</td>\n",
       "      <td>2020-07-17 14:50:40.840</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>Y</td>\n",
       "      <td>FAZIO FARMS OPERATING COMPANY, LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>Y</td>\n",
       "      <td>12.68</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13607017661</td>\n",
       "      <td>faziofarms@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>FAZIO FARMS OPERATING COMPANY, LLC</td>\n",
       "      <td>FAZIO FARMS OPERATING COMPANY, LLC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H-300-20231-773906</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-20 10:38:15.620</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Association - Agent</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>CHARLIE SUNDERLAND</td>\n",
       "      <td>Panter &amp; Sunderland Nursery</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19318083783</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.jobs4tn.gov/vosnet/Default.aspx</td>\n",
       "      <td>0</td>\n",
       "      <td>CHARLIE SUNDERLAND</td>\n",
       "      <td>CHARLIE SUNDERLAND</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H-300-20231-774123</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-24 15:33:14.340</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>MICHAEL RUDEBUSCH</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19369333827</td>\n",
       "      <td>fayethlynpitre@rocketmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>MICHAEL RUDEBUSCH</td>\n",
       "      <td>MICHAEL RUDEBUSCH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H-300-20231-774151</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-21 12:08:09.760</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>LODAHL FARMS</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>14069637560</td>\n",
       "      <td>lodahl_kelsey@yahoo.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>LODAHL FARMS</td>\n",
       "      <td>LODAHL FARMS</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H-300-20231-774508</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-08-20 10:17:34.530</td>\n",
       "      <td>2020-10-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>Y</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>DUNSON HARVESTING, INC.</td>\n",
       "      <td>Dunson Harvesting, Inc.</td>\n",
       "      <td>...</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>18632939888</td>\n",
       "      <td>NaN</td>\n",
       "      <td>www.employflorida.com</td>\n",
       "      <td>4</td>\n",
       "      <td>DUNSON HARVESTING, INC.</td>\n",
       "      <td>DUNSON HARVESTING, INC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 140 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          CASE_NUMBER                           CASE_STATUS  \\\n",
       "0  H-300-20199-721302      Determination Issued - Withdrawn   \n",
       "1  H-300-20231-773906  Determination Issued - Certification   \n",
       "2  H-300-20231-774123  Determination Issued - Certification   \n",
       "3  H-300-20231-774151  Determination Issued - Certification   \n",
       "4  H-300-20231-774508  Determination Issued - Certification   \n",
       "\n",
       "             RECEIVED_DATE            DECISION_DATE  \\\n",
       "0  2020-07-17 14:50:40.840  2020-10-01 00:00:00.000   \n",
       "1  2020-08-20 10:38:15.620  2020-10-01 00:00:00.000   \n",
       "2  2020-08-24 15:33:14.340  2020-10-01 00:00:00.000   \n",
       "3  2020-08-21 12:08:09.760  2020-10-01 00:00:00.000   \n",
       "4  2020-08-20 10:17:34.530  2020-10-01 00:00:00.000   \n",
       "\n",
       "  TYPE_OF_EMPLOYER_APPLICATION H2A_LABOR_CONTRACTOR NATURE_OF_TEMPORARY_NEED  \\\n",
       "0          Individual Employer                    N                 Seasonal   \n",
       "1          Association - Agent                    N                 Seasonal   \n",
       "2          Individual Employer                    N                 Seasonal   \n",
       "3          Individual Employer                    N                 Seasonal   \n",
       "4          Individual Employer                    Y                 Seasonal   \n",
       "\n",
       "  EMERGENCY_FILING                       EMPLOYER_NAME  \\\n",
       "0                Y  FAZIO FARMS OPERATING COMPANY, LLC   \n",
       "1                N                  CHARLIE SUNDERLAND   \n",
       "2                N                   MICHAEL RUDEBUSCH   \n",
       "3                N                        LODAHL FARMS   \n",
       "4                N             DUNSON HARVESTING, INC.   \n",
       "\n",
       "                TRADE_NAME_DBA  ... MEALS_PROVIDED MEALS_CHARGED  \\\n",
       "0                          NaN  ...              Y         12.68   \n",
       "1  Panter & Sunderland Nursery  ...              N           NaN   \n",
       "2                          NaN  ...              N           NaN   \n",
       "3                          NaN  ...              N           NaN   \n",
       "4      Dunson Harvesting, Inc.  ...              N           NaN   \n",
       "\n",
       "  MEAL_REIMBURSEMENT_MINIMUM MEAL_REIMBURSEMENT_MAXIMUM PHONE_TO_APPLY  \\\n",
       "0                      12.68                       55.0    13607017661   \n",
       "1                      12.68                       55.0    19318083783   \n",
       "2                      12.68                       55.0    19369333827   \n",
       "3                      12.68                       55.0    14069637560   \n",
       "4                      12.68                       55.0    18632939888   \n",
       "\n",
       "                  EMAIL_TO_APPLY                             WEBSITE_TO_APPLY  \\\n",
       "0           faziofarms@gmail.com                                          NaN   \n",
       "1                            NaN  https://www.jobs4tn.gov/vosnet/Default.aspx   \n",
       "2  fayethlynpitre@rocketmail.com                                          NaN   \n",
       "3        lodahl_kelsey@yahoo.com                                          NaN   \n",
       "4                            NaN                        www.employflorida.com   \n",
       "\n",
       "   TOTAL_ADDENDUM_A_RECORDS             EMPLOYER_NAME_UPPERCASE  \\\n",
       "0                         0  FAZIO FARMS OPERATING COMPANY, LLC   \n",
       "1                         0                  CHARLIE SUNDERLAND   \n",
       "2                         0                   MICHAEL RUDEBUSCH   \n",
       "3                         0                        LODAHL FARMS   \n",
       "4                         4             DUNSON HARVESTING, INC.   \n",
       "\n",
       "                    clean_punctuation  \n",
       "0  FAZIO FARMS OPERATING COMPANY, LLC  \n",
       "1                  CHARLIE SUNDERLAND  \n",
       "2                   MICHAEL RUDEBUSCH  \n",
       "3                        LODAHL FARMS  \n",
       "4              DUNSON HARVESTING, INC  \n",
       "\n",
       "[5 rows x 140 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Result for testing with positive and negative examples:\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "['CISCO PRODUCE INC', 'AVOYELLES HONEY CO, LLC', 'E.V. RANCH LLP']"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## insert your code here with the regex pattern for part A\n",
    "\n",
    "#regex role in testing debar\n",
    "regex_debar = r\"(INC|LLC|CO)\\.\" # regex pattern for dataset debar\n",
    "\n",
    "clean_punctuation_var = [re.sub(regex_debar, r\"\\1\", one_str) for one_str in debar_clean.Name]\n",
    "\n",
    "debar_clean[\"clean_punctuation\"] = clean_punctuation_var\n",
    "\n",
    "print(\"Result for testing with Debar Dataset Regex rule\")\n",
    "debar_clean.head()\n",
    "\n",
    "#regex role in testing jobs\n",
    "regex_jobs = r\"(INC|LLC|CO)\\.\"  # regex pattern for dataset jobs\n",
    "\n",
    "clean_punctuation_var = [re.sub(regex_jobs, r\"\\1\", one_str) for one_str in jobs.EMPLOYER_NAME]\n",
    "\n",
    "jobs[\"clean_punctuation\"] = clean_punctuation_var\n",
    "\n",
    "print(\"Result for testing with Jobs Dataset Regex rule\")\n",
    "jobs.head()\n",
    "\n",
    "## insert your code to use re.sub to apply the pattern to the test cases for part B\n",
    "\n",
    "\n",
    "regex_part_debar = r\"(INC|LLC|CO)\\.\"\n",
    "\n",
    "clean_punctuation_var = [re.sub(regex_part_debar, r\"\\1\", one_str) for one_str in test_cases]\n",
    "\n",
    "print(\"Result for testing with positive and negative examples:\")\n",
    "clean_punctuation_var"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.3.3 (4 points)\n",
    "\n",
    "Use that pattern in conjunction with `re.sub` and list comprehension to clean the employer name columns in each dataset. Save the new columns as `name_clean` in each. Then, use row subsetting to (1) subset to rows that changed names and (2) for:\n",
    "\n",
    "- `debar_clean` print the `Name` and `name_clean` columns\n",
    "- `jobs` print the `EMPLOYER_NAME` and `name_clean` columns\n",
    "\n",
    "Make sure to use the uppercase versions of the variables\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "# For Jobs data set\n",
    "\n",
    "regex_part_1 = r\"(INC|LLC|CO)\\.\"\n",
    "\n",
    "clean_punctuation_var = [re.sub(regex_part_1, r\"\\1\", one_str) for one_str in jobs.EMPLOYER_NAME]\n",
    "\n",
    "jobs[\"name_clean\"] = clean_punctuation_var\n",
    "\n",
    "# For debar_clean data set\n",
    "\n",
    "regex_part_1 = r\"(INC|LLC|CO)\\.\"\n",
    "\n",
    "clean_punctuation_var = [re.sub(regex_part_1, r\"\\1\", one_str) for one_str in debar_clean.Name]\n",
    "\n",
    "debar_clean[\"name_clean\"] = clean_punctuation_var"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>Violation</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Start date</th>\n",
       "      <th>End date</th>\n",
       "      <th>violnum</th>\n",
       "      <th>Name_Uppercase</th>\n",
       "      <th>clean_punctuation</th>\n",
       "      <th>name_clean</th>\n",
       "      <th>changed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>ANNABELLA LAND &amp; CATTLE</td>\n",
       "      <td>Annabella, UT</td>\n",
       "      <td>Non Payment</td>\n",
       "      <td>1 year</td>\n",
       "      <td>5/9/2014</td>\n",
       "      <td>5/9/2015</td>\n",
       "      <td>1</td>\n",
       "      <td>ANNABELLA LAND &amp; CATTLE</td>\n",
       "      <td>ANNABELLA LAND &amp; CATTLE</td>\n",
       "      <td>ANNABELLA LAND &amp; CATTLE</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>AUTUMN HILL ORCHARD</td>\n",
       "      <td>Groton, MA</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/6/2014</td>\n",
       "      <td>7/5/2016</td>\n",
       "      <td>1</td>\n",
       "      <td>AUTUMN HILL ORCHARD</td>\n",
       "      <td>AUTUMN HILL ORCHARD</td>\n",
       "      <td>AUTUMN HILL ORCHARD</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>CADDO CREEK RANCH, DBA PARADISE RANCH</td>\n",
       "      <td>Caddo, TX</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>7/20/2014</td>\n",
       "      <td>7/19/2016</td>\n",
       "      <td>1</td>\n",
       "      <td>CADDO CREEK RANCH, DBA PARADISE RANCH</td>\n",
       "      <td>CADDO CREEK RANCH, DBA PARADISE RANCH</td>\n",
       "      <td>CADDO CREEK RANCH, DBA PARADISE RANCH</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>LOEWEN HARVESTING LLC</td>\n",
       "      <td>Brownfield, TX</td>\n",
       "      <td>Failure to respond to audit (partial response)</td>\n",
       "      <td>1 year</td>\n",
       "      <td>8/20/2014</td>\n",
       "      <td>8/19/2015</td>\n",
       "      <td>1</td>\n",
       "      <td>LOEWEN HARVESTING LLC</td>\n",
       "      <td>LOEWEN HARVESTING LLC</td>\n",
       "      <td>LOEWEN HARVESTING LLC</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>ROLLO FARM LABOR CONTRACTOR</td>\n",
       "      <td>Miami, FL</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "      <td>2 years</td>\n",
       "      <td>8/23/2014</td>\n",
       "      <td>8/22/2016</td>\n",
       "      <td>1</td>\n",
       "      <td>ROLLO FARM LABOR CONTRACTOR</td>\n",
       "      <td>ROLLO FARM LABOR CONTRACTOR</td>\n",
       "      <td>ROLLO FARM LABOR CONTRACTOR</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>107</th>\n",
       "      <td>WALKER PLACE</td>\n",
       "      <td>Danville, IL</td>\n",
       "      <td>Failure to comply with the employer's obligati...</td>\n",
       "      <td>2 months</td>\n",
       "      <td>11/19/2019</td>\n",
       "      <td>1/26/2020</td>\n",
       "      <td>1</td>\n",
       "      <td>WALKER PLACE</td>\n",
       "      <td>WALKER PLACE</td>\n",
       "      <td>WALKER PLACE</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>108</th>\n",
       "      <td>COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...</td>\n",
       "      <td>Jefferson, ME</td>\n",
       "      <td>WHD Debarment</td>\n",
       "      <td>3 years</td>\n",
       "      <td>3/8/2017</td>\n",
       "      <td>3/8/2020</td>\n",
       "      <td>1</td>\n",
       "      <td>COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...</td>\n",
       "      <td>COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...</td>\n",
       "      <td>COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>110</th>\n",
       "      <td>JESUS LEDESMA</td>\n",
       "      <td>Mulberry, FL</td>\n",
       "      <td>Failure to Respond to Audit Request</td>\n",
       "      <td>2 years</td>\n",
       "      <td>2/8/18</td>\n",
       "      <td>2/8/20</td>\n",
       "      <td>1</td>\n",
       "      <td>JESUS LEDESMA</td>\n",
       "      <td>JESUS LEDESMA</td>\n",
       "      <td>JESUS LEDESMA</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112</th>\n",
       "      <td>B &amp; R HARVESTING AND PAUL CRUZ (INDIVIDUAL)</td>\n",
       "      <td>Collins, GA</td>\n",
       "      <td>WHD Debarment</td>\n",
       "      <td>3 years</td>\n",
       "      <td>4/9/17</td>\n",
       "      <td>4/9/20</td>\n",
       "      <td>1</td>\n",
       "      <td>B &amp; R HARVESTING AND PAUL CRUZ (INDIVIDUAL)</td>\n",
       "      <td>B &amp; R HARVESTING AND PAUL CRUZ (INDIVIDUAL)</td>\n",
       "      <td>B &amp; R HARVESTING AND PAUL CRUZ (INDIVIDUAL)</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>113</th>\n",
       "      <td>DELIA ROJAS</td>\n",
       "      <td>Lyons, GA</td>\n",
       "      <td>WHD Debarment</td>\n",
       "      <td>3 years</td>\n",
       "      <td>4/14/17</td>\n",
       "      <td>4/14/20</td>\n",
       "      <td>1</td>\n",
       "      <td>DELIA ROJAS</td>\n",
       "      <td>DELIA ROJAS</td>\n",
       "      <td>DELIA ROJAS</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>101 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  Name     City, State  \\\n",
       "6                              ANNABELLA LAND & CATTLE   Annabella, UT   \n",
       "7                                  AUTUMN HILL ORCHARD      Groton, MA   \n",
       "8                CADDO CREEK RANCH, DBA PARADISE RANCH       Caddo, TX   \n",
       "11                               LOEWEN HARVESTING LLC  Brownfield, TX   \n",
       "12                         ROLLO FARM LABOR CONTRACTOR       Miami, FL   \n",
       "..                                                 ...             ...   \n",
       "107                                       WALKER PLACE    Danville, IL   \n",
       "108  COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...   Jefferson, ME   \n",
       "110                                      JESUS LEDESMA    Mulberry, FL   \n",
       "112        B & R HARVESTING AND PAUL CRUZ (INDIVIDUAL)     Collins, GA   \n",
       "113                                        DELIA ROJAS       Lyons, GA   \n",
       "\n",
       "                                             Violation  Duration  Start date  \\\n",
       "6                                          Non Payment    1 year    5/9/2014   \n",
       "7            Failure to respond to audit (no response)   2 years    7/6/2014   \n",
       "8       Failure to respond to audit (partial response)   2 years   7/20/2014   \n",
       "11      Failure to respond to audit (partial response)    1 year   8/20/2014   \n",
       "12           Failure to respond to audit (no response)   2 years   8/23/2014   \n",
       "..                                                 ...       ...         ...   \n",
       "107  Failure to comply with the employer's obligati...  2 months  11/19/2019   \n",
       "108                                      WHD Debarment   3 years    3/8/2017   \n",
       "110                Failure to Respond to Audit Request   2 years      2/8/18   \n",
       "112                                      WHD Debarment   3 years      4/9/17   \n",
       "113                                      WHD Debarment   3 years     4/14/17   \n",
       "\n",
       "      End date  violnum                                     Name_Uppercase  \\\n",
       "6     5/9/2015        1                            ANNABELLA LAND & CATTLE   \n",
       "7     7/5/2016        1                                AUTUMN HILL ORCHARD   \n",
       "8    7/19/2016        1              CADDO CREEK RANCH, DBA PARADISE RANCH   \n",
       "11   8/19/2015        1                              LOEWEN HARVESTING LLC   \n",
       "12   8/22/2016        1                        ROLLO FARM LABOR CONTRACTOR   \n",
       "..         ...      ...                                                ...   \n",
       "107  1/26/2020        1                                       WALKER PLACE   \n",
       "108   3/8/2020        1  COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...   \n",
       "110     2/8/20        1                                      JESUS LEDESMA   \n",
       "112     4/9/20        1        B & R HARVESTING AND PAUL CRUZ (INDIVIDUAL)   \n",
       "113    4/14/20        1                                        DELIA ROJAS   \n",
       "\n",
       "                                     clean_punctuation  \\\n",
       "6                              ANNABELLA LAND & CATTLE   \n",
       "7                                  AUTUMN HILL ORCHARD   \n",
       "8                CADDO CREEK RANCH, DBA PARADISE RANCH   \n",
       "11                               LOEWEN HARVESTING LLC   \n",
       "12                         ROLLO FARM LABOR CONTRACTOR   \n",
       "..                                                 ...   \n",
       "107                                       WALKER PLACE   \n",
       "108  COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...   \n",
       "110                                      JESUS LEDESMA   \n",
       "112        B & R HARVESTING AND PAUL CRUZ (INDIVIDUAL)   \n",
       "113                                        DELIA ROJAS   \n",
       "\n",
       "                                            name_clean  changed  \n",
       "6                              ANNABELLA LAND & CATTLE    False  \n",
       "7                                  AUTUMN HILL ORCHARD    False  \n",
       "8                CADDO CREEK RANCH, DBA PARADISE RANCH    False  \n",
       "11                               LOEWEN HARVESTING LLC    False  \n",
       "12                         ROLLO FARM LABOR CONTRACTOR    False  \n",
       "..                                                 ...      ...  \n",
       "107                                       WALKER PLACE    False  \n",
       "108  COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...    False  \n",
       "110                                      JESUS LEDESMA    False  \n",
       "112        B & R HARVESTING AND PAUL CRUZ (INDIVIDUAL)    False  \n",
       "113                                        DELIA ROJAS    False  \n",
       "\n",
       "[101 rows x 11 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "             CASE_NUMBER                           CASE_STATUS  \\\n",
      "1527  H-300-20310-900620  Determination Issued - Certification   \n",
      "1219  H-300-20293-881795  Determination Issued - Certification   \n",
      "1795  H-300-20318-912123  Determination Issued - Certification   \n",
      "1796  H-300-20318-912136  Determination Issued - Certification   \n",
      "1194  H-300-20296-885922  Determination Issued - Certification   \n",
      "...                  ...                                   ...   \n",
      "1036  H-300-20301-889710  Determination Issued - Certification   \n",
      "1037  H-300-20302-890482  Determination Issued - Certification   \n",
      "1038  H-300-20303-891779  Determination Issued - Certification   \n",
      "1040  H-300-20306-894159  Determination Issued - Certification   \n",
      "2719  H-300-20352-967311  Determination Issued - Certification   \n",
      "\n",
      "                RECEIVED_DATE            DECISION_DATE  \\\n",
      "1527  2020-11-06 11:06:35.220  2020-12-08 00:00:00.000   \n",
      "1219  2020-10-26 17:22:36.610  2020-12-01 00:00:00.000   \n",
      "1795  2020-11-16 15:29:41.000  2020-12-15 00:00:00.000   \n",
      "1796  2020-11-17 13:00:59.970  2020-12-15 00:00:00.000   \n",
      "1194  2020-10-26 12:40:21.270  2020-11-30 00:00:00.000   \n",
      "...                       ...                      ...   \n",
      "1036  2020-11-04 08:42:35.900  2020-11-20 00:00:00.000   \n",
      "1037  2020-11-05 11:10:22.030  2020-11-20 00:00:00.000   \n",
      "1038  2020-11-05 09:04:15.230  2020-11-20 00:00:00.000   \n",
      "1040  2020-11-05 16:33:36.150  2020-11-20 00:00:00.000   \n",
      "2719  2020-12-22 11:10:37.480  2020-12-31 00:00:00.000   \n",
      "\n",
      "      TYPE_OF_EMPLOYER_APPLICATION H2A_LABOR_CONTRACTOR  \\\n",
      "1527           Association - Agent                    N   \n",
      "1219           Individual Employer                    N   \n",
      "1795  Association - Joint Employer                    N   \n",
      "1796  Association - Joint Employer                    N   \n",
      "1194           Individual Employer                    N   \n",
      "...                            ...                  ...   \n",
      "1036           Individual Employer                    N   \n",
      "1037           Individual Employer                    N   \n",
      "1038           Individual Employer                    N   \n",
      "1040           Individual Employer                    N   \n",
      "2719           Individual Employer                    N   \n",
      "\n",
      "     NATURE_OF_TEMPORARY_NEED EMERGENCY_FILING  \\\n",
      "1527                 Seasonal                N   \n",
      "1219                 Seasonal                N   \n",
      "1795                 Seasonal                N   \n",
      "1796                 Seasonal                N   \n",
      "1194                 Seasonal                N   \n",
      "...                       ...              ...   \n",
      "1036                 Seasonal                N   \n",
      "1037                 Seasonal                N   \n",
      "1038                 Seasonal                N   \n",
      "1040                 Seasonal                N   \n",
      "2719                 Seasonal                N   \n",
      "\n",
      "                                      EMPLOYER_NAME          TRADE_NAME_DBA  \\\n",
      "1527                THREE Y LIVESTOCK/CHOURNOS INC.                     NaN   \n",
      "1219                       SEVEN UP BAR RANCH, INC.                     NaN   \n",
      "1795  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.  NC Growers Association   \n",
      "1796  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.  NC Growers Association   \n",
      "1194                          GREGORY LIVESTOCK CO.                     NaN   \n",
      "...                                             ...                     ...   \n",
      "1036                     ROLLING STONE FEEDYARD LLC                     NaN   \n",
      "1037                                GROHS CROP CARE                     NaN   \n",
      "1038                              GERARD FREY FARMS                     NaN   \n",
      "1040                             SOUTHWIND ORCHARDS                     NaN   \n",
      "2719                                 HALABURA FARMS                     NaN   \n",
      "\n",
      "      ... MEAL_REIMBURSEMENT_MINIMUM MEAL_REIMBURSEMENT_MAXIMUM  \\\n",
      "1527  ...                      12.68                       55.0   \n",
      "1219  ...                      12.68                       55.0   \n",
      "1795  ...                      12.68                       55.0   \n",
      "1796  ...                      12.68                       55.0   \n",
      "1194  ...                      12.68                       55.0   \n",
      "...   ...                        ...                        ...   \n",
      "1036  ...                      12.68                       55.0   \n",
      "1037  ...                      12.68                       55.0   \n",
      "1038  ...                      12.68                       55.0   \n",
      "1040  ...                      12.68                       55.0   \n",
      "2719  ...                      12.68                       55.0   \n",
      "\n",
      "     PHONE_TO_APPLY                  EMAIL_TO_APPLY  \\\n",
      "1527    13074722105                 info@mpaswy.com   \n",
      "1219            NaN  H-2AJobs@snakeriverfarmers.org   \n",
      "1795    12525270567           lwicker@ncgrowers.org   \n",
      "1796    12525270567           lwicker@ncgrowers.org   \n",
      "1194    19168999130      gregorylivestock@yahoo.com   \n",
      "...             ...                             ...   \n",
      "1036    14023871522             rsfy@threeriver.net   \n",
      "1037    16057786571            cropcareth@gmail.com   \n",
      "1038    13377792261                danafrey@aol.com   \n",
      "1040    19523000594     southwindorchards@gmail.com   \n",
      "2719            NaN          referrals@maslabor.com   \n",
      "\n",
      "                     WEBSITE_TO_APPLY TOTAL_ADDENDUM_A_RECORDS  \\\n",
      "1527                              NaN                        0   \n",
      "1219        https://montanaworks.gov/                        0   \n",
      "1795                              NaN                        0   \n",
      "1796                              NaN                        0   \n",
      "1194                              NaN                        0   \n",
      "...                               ...                      ...   \n",
      "1036                              NaN                        0   \n",
      "1037                              NaN                        0   \n",
      "1038                      laworks.net                        2   \n",
      "1040                              NaN                        1   \n",
      "2719  https://www.pacareerlink.pa.gov                        0   \n",
      "\n",
      "                            EMPLOYER_NAME_UPPERCASE  \\\n",
      "1527                THREE Y LIVESTOCK/CHOURNOS INC.   \n",
      "1219                       SEVEN UP BAR RANCH, INC.   \n",
      "1795  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.   \n",
      "1796  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.   \n",
      "1194                          GREGORY LIVESTOCK CO.   \n",
      "...                                             ...   \n",
      "1036                     ROLLING STONE FEEDYARD LLC   \n",
      "1037                                GROHS CROP CARE   \n",
      "1038                              GERARD FREY FARMS   \n",
      "1040                             SOUTHWIND ORCHARDS   \n",
      "2719                                 HALABURA FARMS   \n",
      "\n",
      "                                 clean_punctuation  \\\n",
      "1527                THREE Y LIVESTOCK/CHOURNOS INC   \n",
      "1219                       SEVEN UP BAR RANCH, INC   \n",
      "1795  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC   \n",
      "1796  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC   \n",
      "1194                          GREGORY LIVESTOCK CO   \n",
      "...                                            ...   \n",
      "1036                    ROLLING STONE FEEDYARD LLC   \n",
      "1037                               GROHS CROP CARE   \n",
      "1038                             GERARD FREY FARMS   \n",
      "1040                            SOUTHWIND ORCHARDS   \n",
      "2719                                HALABURA FARMS   \n",
      "\n",
      "                                        name_clean  changed  \n",
      "1527                THREE Y LIVESTOCK/CHOURNOS INC     True  \n",
      "1219                       SEVEN UP BAR RANCH, INC     True  \n",
      "1795  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC     True  \n",
      "1796  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC     True  \n",
      "1194                          GREGORY LIVESTOCK CO     True  \n",
      "...                                            ...      ...  \n",
      "1036                    ROLLING STONE FEEDYARD LLC    False  \n",
      "1037                               GROHS CROP CARE    False  \n",
      "1038                             GERARD FREY FARMS    False  \n",
      "1040                            SOUTHWIND ORCHARDS    False  \n",
      "2719                                HALABURA FARMS    False  \n",
      "\n",
      "[2720 rows x 142 columns]\n",
      "                         Name             City, State  \\\n",
      "33         GERONIMO SHEEP CO.              Vernal, UT   \n",
      "91   AVOYELLES HONEY CO., LLC  Moreauville, Louisiana   \n",
      "3       ANTON FERTILIZER INC.             Dighton, KS   \n",
      "13              REIMER'S INC.               Lakin, KS   \n",
      "46   ALTENDORF TRANSPORT INC.               Minto, ND   \n",
      "..                        ...                     ...   \n",
      "38                LESLIE COOK            Carlisle, KY   \n",
      "37               JOHN R. COOK            Carlisle, KY   \n",
      "36                AGECY I LLC              Idabel, OK   \n",
      "35                IRISH FLATS           Montezuma, KS   \n",
      "113               DELIA ROJAS               Lyons, GA   \n",
      "\n",
      "                                      Violation Duration Start date  \\\n",
      "33                                WHD Debarment  3 years  6/23/2014   \n",
      "91          Failure to respond to audit request  2 years  9/11/2016   \n",
      "3     Failure to respond to audit (no response)  2 years  3/30/2014   \n",
      "13    Failure to respond to audit (no response)  2 years  8/23/2014   \n",
      "46   Impeding the Audit Process – Non- Response  2 years  4/24/2015   \n",
      "..                                          ...      ...        ...   \n",
      "38   Impeding the Audit Process – Non- Response  2 years  7/22/2015   \n",
      "37   Impeding the Audit Process – Non- Response  2 years  8/27/2015   \n",
      "36   Impeding the Audit Process – Non- Response  2 years  8/27/2015   \n",
      "35   Impeding the Audit Process – Non- Response  2 years  9/30/2015   \n",
      "113                               WHD Debarment  3 years    4/14/17   \n",
      "\n",
      "      End date  violnum            Name_Uppercase        clean_punctuation  \\\n",
      "33   6/22/2017        1        GERONIMO SHEEP CO.        GERONIMO SHEEP CO   \n",
      "91   9/11/2017        1  AVOYELLES HONEY CO., LLC  AVOYELLES HONEY CO, LLC   \n",
      "3    3/29/2016        1     ANTON FERTILIZER INC.     ANTON FERTILIZER INC   \n",
      "13   8/22/2016        1             REIMER'S INC.             REIMER'S INC   \n",
      "46   4/23/2017        1  ALTENDORF TRANSPORT INC.  ALTENDORF TRANSPORT INC   \n",
      "..         ...      ...                       ...                      ...   \n",
      "38   7/22/2017        1               LESLIE COOK              LESLIE COOK   \n",
      "37   8/26/2017        1              JOHN R. COOK             JOHN R. COOK   \n",
      "36   8/26/2017        1               AGECY I LLC              AGECY I LLC   \n",
      "35   9/29/2017        1               IRISH FLATS              IRISH FLATS   \n",
      "113    4/14/20        1               DELIA ROJAS              DELIA ROJAS   \n",
      "\n",
      "                  name_clean  changed  \n",
      "33         GERONIMO SHEEP CO     True  \n",
      "91   AVOYELLES HONEY CO, LLC     True  \n",
      "3       ANTON FERTILIZER INC     True  \n",
      "13              REIMER'S INC     True  \n",
      "46   ALTENDORF TRANSPORT INC     True  \n",
      "..                       ...      ...  \n",
      "38               LESLIE COOK    False  \n",
      "37              JOHN R. COOK    False  \n",
      "36               AGECY I LLC    False  \n",
      "35               IRISH FLATS    False  \n",
      "113              DELIA ROJAS    False  \n",
      "\n",
      "[101 rows x 11 columns]\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CASE_NUMBER</th>\n",
       "      <th>CASE_STATUS</th>\n",
       "      <th>RECEIVED_DATE</th>\n",
       "      <th>DECISION_DATE</th>\n",
       "      <th>TYPE_OF_EMPLOYER_APPLICATION</th>\n",
       "      <th>H2A_LABOR_CONTRACTOR</th>\n",
       "      <th>NATURE_OF_TEMPORARY_NEED</th>\n",
       "      <th>EMERGENCY_FILING</th>\n",
       "      <th>EMPLOYER_NAME</th>\n",
       "      <th>TRADE_NAME_DBA</th>\n",
       "      <th>...</th>\n",
       "      <th>MEAL_REIMBURSEMENT_MINIMUM</th>\n",
       "      <th>MEAL_REIMBURSEMENT_MAXIMUM</th>\n",
       "      <th>PHONE_TO_APPLY</th>\n",
       "      <th>EMAIL_TO_APPLY</th>\n",
       "      <th>WEBSITE_TO_APPLY</th>\n",
       "      <th>TOTAL_ADDENDUM_A_RECORDS</th>\n",
       "      <th>EMPLOYER_NAME_UPPERCASE</th>\n",
       "      <th>clean_punctuation</th>\n",
       "      <th>name_clean</th>\n",
       "      <th>changed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1527</th>\n",
       "      <td>H-300-20310-900620</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-11-06 11:06:35.220</td>\n",
       "      <td>2020-12-08 00:00:00.000</td>\n",
       "      <td>Association - Agent</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>THREE Y LIVESTOCK/CHOURNOS INC.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13074722105</td>\n",
       "      <td>info@mpaswy.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>THREE Y LIVESTOCK/CHOURNOS INC.</td>\n",
       "      <td>THREE Y LIVESTOCK/CHOURNOS INC</td>\n",
       "      <td>THREE Y LIVESTOCK/CHOURNOS INC</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1219</th>\n",
       "      <td>H-300-20293-881795</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-10-26 17:22:36.610</td>\n",
       "      <td>2020-12-01 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>SEVEN UP BAR RANCH, INC.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>H-2AJobs@snakeriverfarmers.org</td>\n",
       "      <td>https://montanaworks.gov/</td>\n",
       "      <td>0</td>\n",
       "      <td>SEVEN UP BAR RANCH, INC.</td>\n",
       "      <td>SEVEN UP BAR RANCH, INC</td>\n",
       "      <td>SEVEN UP BAR RANCH, INC</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1795</th>\n",
       "      <td>H-300-20318-912123</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-11-16 15:29:41.000</td>\n",
       "      <td>2020-12-15 00:00:00.000</td>\n",
       "      <td>Association - Joint Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.</td>\n",
       "      <td>NC Growers Association</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>12525270567</td>\n",
       "      <td>lwicker@ncgrowers.org</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.</td>\n",
       "      <td>THE NORTH CAROLINA GROWER'S ASSOCIATION, INC</td>\n",
       "      <td>THE NORTH CAROLINA GROWER'S ASSOCIATION, INC</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1796</th>\n",
       "      <td>H-300-20318-912136</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-11-17 13:00:59.970</td>\n",
       "      <td>2020-12-15 00:00:00.000</td>\n",
       "      <td>Association - Joint Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.</td>\n",
       "      <td>NC Growers Association</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>12525270567</td>\n",
       "      <td>lwicker@ncgrowers.org</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.</td>\n",
       "      <td>THE NORTH CAROLINA GROWER'S ASSOCIATION, INC</td>\n",
       "      <td>THE NORTH CAROLINA GROWER'S ASSOCIATION, INC</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1194</th>\n",
       "      <td>H-300-20296-885922</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-10-26 12:40:21.270</td>\n",
       "      <td>2020-11-30 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>GREGORY LIVESTOCK CO.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19168999130</td>\n",
       "      <td>gregorylivestock@yahoo.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>GREGORY LIVESTOCK CO.</td>\n",
       "      <td>GREGORY LIVESTOCK CO</td>\n",
       "      <td>GREGORY LIVESTOCK CO</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1036</th>\n",
       "      <td>H-300-20301-889710</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-11-04 08:42:35.900</td>\n",
       "      <td>2020-11-20 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>ROLLING STONE FEEDYARD LLC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>14023871522</td>\n",
       "      <td>rsfy@threeriver.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>ROLLING STONE FEEDYARD LLC</td>\n",
       "      <td>ROLLING STONE FEEDYARD LLC</td>\n",
       "      <td>ROLLING STONE FEEDYARD LLC</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1037</th>\n",
       "      <td>H-300-20302-890482</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-11-05 11:10:22.030</td>\n",
       "      <td>2020-11-20 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>GROHS CROP CARE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>16057786571</td>\n",
       "      <td>cropcareth@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>GROHS CROP CARE</td>\n",
       "      <td>GROHS CROP CARE</td>\n",
       "      <td>GROHS CROP CARE</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1038</th>\n",
       "      <td>H-300-20303-891779</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-11-05 09:04:15.230</td>\n",
       "      <td>2020-11-20 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>GERARD FREY FARMS</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>13377792261</td>\n",
       "      <td>danafrey@aol.com</td>\n",
       "      <td>laworks.net</td>\n",
       "      <td>2</td>\n",
       "      <td>GERARD FREY FARMS</td>\n",
       "      <td>GERARD FREY FARMS</td>\n",
       "      <td>GERARD FREY FARMS</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1040</th>\n",
       "      <td>H-300-20306-894159</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-11-05 16:33:36.150</td>\n",
       "      <td>2020-11-20 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>SOUTHWIND ORCHARDS</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>19523000594</td>\n",
       "      <td>southwindorchards@gmail.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>SOUTHWIND ORCHARDS</td>\n",
       "      <td>SOUTHWIND ORCHARDS</td>\n",
       "      <td>SOUTHWIND ORCHARDS</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2719</th>\n",
       "      <td>H-300-20352-967311</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-12-22 11:10:37.480</td>\n",
       "      <td>2020-12-31 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>N</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>N</td>\n",
       "      <td>HALABURA FARMS</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>12.68</td>\n",
       "      <td>55.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>referrals@maslabor.com</td>\n",
       "      <td>https://www.pacareerlink.pa.gov</td>\n",
       "      <td>0</td>\n",
       "      <td>HALABURA FARMS</td>\n",
       "      <td>HALABURA FARMS</td>\n",
       "      <td>HALABURA FARMS</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2720 rows × 142 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             CASE_NUMBER                           CASE_STATUS  \\\n",
       "1527  H-300-20310-900620  Determination Issued - Certification   \n",
       "1219  H-300-20293-881795  Determination Issued - Certification   \n",
       "1795  H-300-20318-912123  Determination Issued - Certification   \n",
       "1796  H-300-20318-912136  Determination Issued - Certification   \n",
       "1194  H-300-20296-885922  Determination Issued - Certification   \n",
       "...                  ...                                   ...   \n",
       "1036  H-300-20301-889710  Determination Issued - Certification   \n",
       "1037  H-300-20302-890482  Determination Issued - Certification   \n",
       "1038  H-300-20303-891779  Determination Issued - Certification   \n",
       "1040  H-300-20306-894159  Determination Issued - Certification   \n",
       "2719  H-300-20352-967311  Determination Issued - Certification   \n",
       "\n",
       "                RECEIVED_DATE            DECISION_DATE  \\\n",
       "1527  2020-11-06 11:06:35.220  2020-12-08 00:00:00.000   \n",
       "1219  2020-10-26 17:22:36.610  2020-12-01 00:00:00.000   \n",
       "1795  2020-11-16 15:29:41.000  2020-12-15 00:00:00.000   \n",
       "1796  2020-11-17 13:00:59.970  2020-12-15 00:00:00.000   \n",
       "1194  2020-10-26 12:40:21.270  2020-11-30 00:00:00.000   \n",
       "...                       ...                      ...   \n",
       "1036  2020-11-04 08:42:35.900  2020-11-20 00:00:00.000   \n",
       "1037  2020-11-05 11:10:22.030  2020-11-20 00:00:00.000   \n",
       "1038  2020-11-05 09:04:15.230  2020-11-20 00:00:00.000   \n",
       "1040  2020-11-05 16:33:36.150  2020-11-20 00:00:00.000   \n",
       "2719  2020-12-22 11:10:37.480  2020-12-31 00:00:00.000   \n",
       "\n",
       "      TYPE_OF_EMPLOYER_APPLICATION H2A_LABOR_CONTRACTOR  \\\n",
       "1527           Association - Agent                    N   \n",
       "1219           Individual Employer                    N   \n",
       "1795  Association - Joint Employer                    N   \n",
       "1796  Association - Joint Employer                    N   \n",
       "1194           Individual Employer                    N   \n",
       "...                            ...                  ...   \n",
       "1036           Individual Employer                    N   \n",
       "1037           Individual Employer                    N   \n",
       "1038           Individual Employer                    N   \n",
       "1040           Individual Employer                    N   \n",
       "2719           Individual Employer                    N   \n",
       "\n",
       "     NATURE_OF_TEMPORARY_NEED EMERGENCY_FILING  \\\n",
       "1527                 Seasonal                N   \n",
       "1219                 Seasonal                N   \n",
       "1795                 Seasonal                N   \n",
       "1796                 Seasonal                N   \n",
       "1194                 Seasonal                N   \n",
       "...                       ...              ...   \n",
       "1036                 Seasonal                N   \n",
       "1037                 Seasonal                N   \n",
       "1038                 Seasonal                N   \n",
       "1040                 Seasonal                N   \n",
       "2719                 Seasonal                N   \n",
       "\n",
       "                                      EMPLOYER_NAME          TRADE_NAME_DBA  \\\n",
       "1527                THREE Y LIVESTOCK/CHOURNOS INC.                     NaN   \n",
       "1219                       SEVEN UP BAR RANCH, INC.                     NaN   \n",
       "1795  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.  NC Growers Association   \n",
       "1796  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.  NC Growers Association   \n",
       "1194                          GREGORY LIVESTOCK CO.                     NaN   \n",
       "...                                             ...                     ...   \n",
       "1036                     ROLLING STONE FEEDYARD LLC                     NaN   \n",
       "1037                                GROHS CROP CARE                     NaN   \n",
       "1038                              GERARD FREY FARMS                     NaN   \n",
       "1040                             SOUTHWIND ORCHARDS                     NaN   \n",
       "2719                                 HALABURA FARMS                     NaN   \n",
       "\n",
       "      ... MEAL_REIMBURSEMENT_MINIMUM MEAL_REIMBURSEMENT_MAXIMUM  \\\n",
       "1527  ...                      12.68                       55.0   \n",
       "1219  ...                      12.68                       55.0   \n",
       "1795  ...                      12.68                       55.0   \n",
       "1796  ...                      12.68                       55.0   \n",
       "1194  ...                      12.68                       55.0   \n",
       "...   ...                        ...                        ...   \n",
       "1036  ...                      12.68                       55.0   \n",
       "1037  ...                      12.68                       55.0   \n",
       "1038  ...                      12.68                       55.0   \n",
       "1040  ...                      12.68                       55.0   \n",
       "2719  ...                      12.68                       55.0   \n",
       "\n",
       "     PHONE_TO_APPLY                  EMAIL_TO_APPLY  \\\n",
       "1527    13074722105                 info@mpaswy.com   \n",
       "1219            NaN  H-2AJobs@snakeriverfarmers.org   \n",
       "1795    12525270567           lwicker@ncgrowers.org   \n",
       "1796    12525270567           lwicker@ncgrowers.org   \n",
       "1194    19168999130      gregorylivestock@yahoo.com   \n",
       "...             ...                             ...   \n",
       "1036    14023871522             rsfy@threeriver.net   \n",
       "1037    16057786571            cropcareth@gmail.com   \n",
       "1038    13377792261                danafrey@aol.com   \n",
       "1040    19523000594     southwindorchards@gmail.com   \n",
       "2719            NaN          referrals@maslabor.com   \n",
       "\n",
       "                     WEBSITE_TO_APPLY TOTAL_ADDENDUM_A_RECORDS  \\\n",
       "1527                              NaN                        0   \n",
       "1219        https://montanaworks.gov/                        0   \n",
       "1795                              NaN                        0   \n",
       "1796                              NaN                        0   \n",
       "1194                              NaN                        0   \n",
       "...                               ...                      ...   \n",
       "1036                              NaN                        0   \n",
       "1037                              NaN                        0   \n",
       "1038                      laworks.net                        2   \n",
       "1040                              NaN                        1   \n",
       "2719  https://www.pacareerlink.pa.gov                        0   \n",
       "\n",
       "                            EMPLOYER_NAME_UPPERCASE  \\\n",
       "1527                THREE Y LIVESTOCK/CHOURNOS INC.   \n",
       "1219                       SEVEN UP BAR RANCH, INC.   \n",
       "1795  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.   \n",
       "1796  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC.   \n",
       "1194                          GREGORY LIVESTOCK CO.   \n",
       "...                                             ...   \n",
       "1036                     ROLLING STONE FEEDYARD LLC   \n",
       "1037                                GROHS CROP CARE   \n",
       "1038                              GERARD FREY FARMS   \n",
       "1040                             SOUTHWIND ORCHARDS   \n",
       "2719                                 HALABURA FARMS   \n",
       "\n",
       "                                 clean_punctuation  \\\n",
       "1527                THREE Y LIVESTOCK/CHOURNOS INC   \n",
       "1219                       SEVEN UP BAR RANCH, INC   \n",
       "1795  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC   \n",
       "1796  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC   \n",
       "1194                          GREGORY LIVESTOCK CO   \n",
       "...                                            ...   \n",
       "1036                    ROLLING STONE FEEDYARD LLC   \n",
       "1037                               GROHS CROP CARE   \n",
       "1038                             GERARD FREY FARMS   \n",
       "1040                            SOUTHWIND ORCHARDS   \n",
       "2719                                HALABURA FARMS   \n",
       "\n",
       "                                        name_clean  changed  \n",
       "1527                THREE Y LIVESTOCK/CHOURNOS INC     True  \n",
       "1219                       SEVEN UP BAR RANCH, INC     True  \n",
       "1795  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC     True  \n",
       "1796  THE NORTH CAROLINA GROWER'S ASSOCIATION, INC     True  \n",
       "1194                          GREGORY LIVESTOCK CO     True  \n",
       "...                                            ...      ...  \n",
       "1036                    ROLLING STONE FEEDYARD LLC    False  \n",
       "1037                               GROHS CROP CARE    False  \n",
       "1038                             GERARD FREY FARMS    False  \n",
       "1040                            SOUTHWIND ORCHARDS    False  \n",
       "2719                                HALABURA FARMS    False  \n",
       "\n",
       "[2720 rows x 142 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Changed rows in jobs:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>EMPLOYER_NAME</th>\n",
       "      <th>name_clean</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>DUNSON HARVESTING, INC.</td>\n",
       "      <td>DUNSON HARVESTING, INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>FARM LABOR ASSOCIATION FOR GROWERS, INC.</td>\n",
       "      <td>FARM LABOR ASSOCIATION FOR GROWERS, INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>MCLAIN FARMS, INC.</td>\n",
       "      <td>MCLAIN FARMS, INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>BONNIE PLANTS, INC.</td>\n",
       "      <td>BONNIE PLANTS, INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>B &amp; W QUALITY GROWERS, INC.</td>\n",
       "      <td>B &amp; W QUALITY GROWERS, INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2700</th>\n",
       "      <td>HARRAL LIVESTOCK CO. LLC</td>\n",
       "      <td>HARRAL LIVESTOCK CO LLC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2701</th>\n",
       "      <td>ECOSYSTEM CONCEPTS INC.</td>\n",
       "      <td>ECOSYSTEM CONCEPTS INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2702</th>\n",
       "      <td>SIDDOWAY SHEEP CO.</td>\n",
       "      <td>SIDDOWAY SHEEP CO</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2705</th>\n",
       "      <td>SATHER MANAGEMENT INC.</td>\n",
       "      <td>SATHER MANAGEMENT INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2711</th>\n",
       "      <td>C R KOEHL AND SONS INC.</td>\n",
       "      <td>C R KOEHL AND SONS INC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>576 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 EMPLOYER_NAME  \\\n",
       "4                      DUNSON HARVESTING, INC.   \n",
       "7     FARM LABOR ASSOCIATION FOR GROWERS, INC.   \n",
       "14                          MCLAIN FARMS, INC.   \n",
       "17                         BONNIE PLANTS, INC.   \n",
       "18                 B & W QUALITY GROWERS, INC.   \n",
       "...                                        ...   \n",
       "2700                  HARRAL LIVESTOCK CO. LLC   \n",
       "2701                   ECOSYSTEM CONCEPTS INC.   \n",
       "2702                        SIDDOWAY SHEEP CO.   \n",
       "2705                    SATHER MANAGEMENT INC.   \n",
       "2711                   C R KOEHL AND SONS INC.   \n",
       "\n",
       "                                   name_clean  \n",
       "4                      DUNSON HARVESTING, INC  \n",
       "7     FARM LABOR ASSOCIATION FOR GROWERS, INC  \n",
       "14                          MCLAIN FARMS, INC  \n",
       "17                         BONNIE PLANTS, INC  \n",
       "18                 B & W QUALITY GROWERS, INC  \n",
       "...                                       ...  \n",
       "2700                  HARRAL LIVESTOCK CO LLC  \n",
       "2701                   ECOSYSTEM CONCEPTS INC  \n",
       "2702                        SIDDOWAY SHEEP CO  \n",
       "2705                    SATHER MANAGEMENT INC  \n",
       "2711                   C R KOEHL AND SONS INC  \n",
       "\n",
       "[576 rows x 2 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Changed rows in debar_clean:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>name_clean</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ANTON FERTILIZER INC.</td>\n",
       "      <td>ANTON FERTILIZER INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>GREAT PLAINS FLUID SERVICE, INC.</td>\n",
       "      <td>GREAT PLAINS FLUID SERVICE, INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>PROMAX INC.</td>\n",
       "      <td>PROMAX INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>REIMER'S INC.</td>\n",
       "      <td>REIMER'S INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>CISCO PRODUCE INC.</td>\n",
       "      <td>CISCO PRODUCE INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>REIMER’S INC.</td>\n",
       "      <td>REIMER’S INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>GERONIMO SHEEP CO.</td>\n",
       "      <td>GERONIMO SHEEP CO</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>ALTENDORF TRANSPORT INC.</td>\n",
       "      <td>ALTENDORF TRANSPORT INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>CISCO PRODUCE INC.</td>\n",
       "      <td>CISCO PRODUCE INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>72</th>\n",
       "      <td>SAXTONS RIVER ORCHARDS, INC.</td>\n",
       "      <td>SAXTONS RIVER ORCHARDS, INC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>AVOYELLES HONEY CO., LLC</td>\n",
       "      <td>AVOYELLES HONEY CO, LLC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                Name                       name_clean\n",
       "3              ANTON FERTILIZER INC.             ANTON FERTILIZER INC\n",
       "4   GREAT PLAINS FLUID SERVICE, INC.  GREAT PLAINS FLUID SERVICE, INC\n",
       "5                        PROMAX INC.                       PROMAX INC\n",
       "13                     REIMER'S INC.                     REIMER'S INC\n",
       "19                CISCO PRODUCE INC.                CISCO PRODUCE INC\n",
       "23                     REIMER’S INC.                     REIMER’S INC\n",
       "33                GERONIMO SHEEP CO.                GERONIMO SHEEP CO\n",
       "46          ALTENDORF TRANSPORT INC.          ALTENDORF TRANSPORT INC\n",
       "56                CISCO PRODUCE INC.                CISCO PRODUCE INC\n",
       "72      SAXTONS RIVER ORCHARDS, INC.      SAXTONS RIVER ORCHARDS, INC\n",
       "91          AVOYELLES HONEY CO., LLC          AVOYELLES HONEY CO, LLC"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# use row subsetting to subset to rows that changed names:\n",
    "# For Jobs data set\n",
    "\n",
    "jobs[\"EMPLOYER_NAME\"] = jobs[\"EMPLOYER_NAME\"].astype(str)\n",
    "jobs[\"name_clean\"] = jobs[\"name_clean\"].astype(str)\n",
    "\n",
    "jobs[\"changed\"] = jobs[\"EMPLOYER_NAME\"] != jobs[\"name_clean\"]\n",
    "\n",
    "#For debar_clean \n",
    "\n",
    "debar_clean[\"Name\"] = debar_clean[\"Name\"].astype(str)\n",
    "debar_clean[\"name_clean\"] = debar_clean[\"name_clean\"].astype(str)\n",
    "\n",
    "debar_clean[\"changed\"] = debar_clean[\"Name\"] != debar_clean[\"name_clean\"]\n",
    "\n",
    "debar_clean\n",
    "#print\n",
    "print(jobs.sort_values(by=\"changed\", ascending=False))\n",
    "print(debar_clean.sort_values(by=\"changed\", ascending=False))\n",
    "\n",
    "#subset part 2:\n",
    "\n",
    "jobs.sort_values(by=\"changed\", ascending=False)\n",
    "\n",
    "print(\"Changed rows in jobs:\")\n",
    "jobs[jobs[\"changed\"]][[\"EMPLOYER_NAME\", \"name_clean\"]]\n",
    "\n",
    "print(\"Changed rows in debar_clean:\")\n",
    "debar_clean[debar_clean[\"changed\"]][[\"Name\", \"name_clean\"]]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.4 More joins and more cleaning (5 points)\n",
    "\n",
    "A. Conduct another inner join between `jobs` and `debar_clean` now using the `name_clean` column; print the result. Did the cleaning result in any more employers matched between the two datasets?\n",
    "\n",
    "B. Create a new column in `debar_clean` called `name_clean_2` that uses regex to take the following name in that dataset:\n",
    "\n",
    "- `SLASH E.V. RANCH LLP` in the `debar_clean` dataset\n",
    "\n",
    "And cleans it up so that it matches with this employer in `jobs`\n",
    "\n",
    "- `SLASH EV RANCH` in the `jobs` dataset\n",
    "\n",
    "Eg a pattern to remove the dots in the EV and the space+LLP-- you can apply the pattern to all employer names in debar_clean (so don't need to worry about only applying it to that one employer)\n",
    "\n",
    "\n",
    "C. Conduct a left join using `name_clean_2` as the join column where the left hand dataframe is `jobs`; right hand dataframe is `debar_clean`, store the result as a dataframe, and print the rows where the merge indicator indicates the row was found in both dataframe\n",
    "\n",
    "**Note**: this manual cleaning process is inefficient and helps motivate why talked about fuzzy matching. Fuzzy matching could recognize that Slash EV ranch is a highly similar string to slash ev ranch llp and match them without us needing to use regex to make the strings identical."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CASE_NUMBER</th>\n",
       "      <th>CASE_STATUS</th>\n",
       "      <th>RECEIVED_DATE</th>\n",
       "      <th>DECISION_DATE</th>\n",
       "      <th>TYPE_OF_EMPLOYER_APPLICATION</th>\n",
       "      <th>H2A_LABOR_CONTRACTOR</th>\n",
       "      <th>NATURE_OF_TEMPORARY_NEED</th>\n",
       "      <th>EMERGENCY_FILING</th>\n",
       "      <th>EMPLOYER_NAME</th>\n",
       "      <th>TRADE_NAME_DBA</th>\n",
       "      <th>...</th>\n",
       "      <th>Name</th>\n",
       "      <th>City, State</th>\n",
       "      <th>Violation</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Start date</th>\n",
       "      <th>End date</th>\n",
       "      <th>violnum</th>\n",
       "      <th>Name_Uppercase</th>\n",
       "      <th>clean_punctuation_y</th>\n",
       "      <th>changed_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H-300-20287-876656</td>\n",
       "      <td>Determination Issued - Certification</td>\n",
       "      <td>2020-10-20 09:20:32.010</td>\n",
       "      <td>2020-11-09 00:00:00.000</td>\n",
       "      <td>Individual Employer</td>\n",
       "      <td>Y</td>\n",
       "      <td>Seasonal</td>\n",
       "      <td>Y</td>\n",
       "      <td>RAFAEL BARAJAS</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>RAFAEL BARAJAS</td>\n",
       "      <td>Sebring, Florida</td>\n",
       "      <td>Non-payment of certification fee</td>\n",
       "      <td>1 year</td>\n",
       "      <td>9/23/2016</td>\n",
       "      <td>9/22/2017</td>\n",
       "      <td>1</td>\n",
       "      <td>RAFAEL BARAJAS</td>\n",
       "      <td>RAFAEL BARAJAS</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1 rows × 152 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          CASE_NUMBER                           CASE_STATUS  \\\n",
       "0  H-300-20287-876656  Determination Issued - Certification   \n",
       "\n",
       "             RECEIVED_DATE            DECISION_DATE  \\\n",
       "0  2020-10-20 09:20:32.010  2020-11-09 00:00:00.000   \n",
       "\n",
       "  TYPE_OF_EMPLOYER_APPLICATION H2A_LABOR_CONTRACTOR NATURE_OF_TEMPORARY_NEED  \\\n",
       "0          Individual Employer                    Y                 Seasonal   \n",
       "\n",
       "  EMERGENCY_FILING   EMPLOYER_NAME TRADE_NAME_DBA  ...            Name  \\\n",
       "0                Y  RAFAEL BARAJAS            NaN  ...  RAFAEL BARAJAS   \n",
       "\n",
       "        City, State                         Violation Duration Start date  \\\n",
       "0  Sebring, Florida  Non-payment of certification fee   1 year  9/23/2016   \n",
       "\n",
       "    End date violnum  Name_Uppercase  clean_punctuation_y  changed_y  \n",
       "0  9/22/2017       1  RAFAEL BARAJAS       RAFAEL BARAJAS      False  \n",
       "\n",
       "[1 rows x 152 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No it did not\n"
     ]
    }
   ],
   "source": [
    "## your code here\n",
    "\n",
    "# Part A:\n",
    "\n",
    "jobs.merge(debar_clean, on = \"name_clean\", how = \"inner\")\n",
    "\n",
    "print(\"No it did not\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "## Part B:\n",
    "\n",
    "# Define the regex to remove dots and \" LLP\"\n",
    "regex_2 = r'\\.|\\sLLP'\n",
    "\n",
    "# Function to clean each name\n",
    "def clean_name(name):\n",
    "    return re.sub(regex_2, '', name)\n",
    "\n",
    "# Create \"name_clean_2\" in debar_clean\n",
    "debar_clean[\"name_clean_2\"] = debar_clean[\"Name\"].apply(clean_name)\n",
    "\n",
    "# Create \"name_clean_2\" in jobs\n",
    "jobs[\"name_clean_2\"] = jobs[\"EMPLOYER_NAME\"].apply(clean_name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "             CASE_NUMBER                           CASE_STATUS  \\\n",
      "791   H-300-20287-876656  Determination Issued - Certification   \n",
      "1115  H-300-20306-894148  Determination Issued - Certification   \n",
      "\n",
      "                RECEIVED_DATE            DECISION_DATE  \\\n",
      "791   2020-10-20 09:20:32.010  2020-11-09 00:00:00.000   \n",
      "1115  2020-11-02 18:11:29.140  2020-11-24 00:00:00.000   \n",
      "\n",
      "     TYPE_OF_EMPLOYER_APPLICATION H2A_LABOR_CONTRACTOR  \\\n",
      "791           Individual Employer                    Y   \n",
      "1115          Individual Employer                    N   \n",
      "\n",
      "     NATURE_OF_TEMPORARY_NEED EMERGENCY_FILING   EMPLOYER_NAME TRADE_NAME_DBA  \\\n",
      "791                  Seasonal                Y  RAFAEL BARAJAS            NaN   \n",
      "1115                 Seasonal                N  SLASH EV RANCH            NaN   \n",
      "\n",
      "      ...                         Violation Duration  Start date    End date  \\\n",
      "791   ...  Non-payment of certification fee   1 year   9/23/2016   9/22/2017   \n",
      "1115  ...                     WHD Debarment   1 year  11/15/2014  11/14/2015   \n",
      "\n",
      "     violnum        Name_Uppercase   clean_punctuation_y  \\\n",
      "791      1.0        RAFAEL BARAJAS        RAFAEL BARAJAS   \n",
      "1115     1.0  SLASH E.V. RANCH LLP  SLASH E.V. RANCH LLP   \n",
      "\n",
      "              name_clean_y  changed_y  _merge  \n",
      "791         RAFAEL BARAJAS      False    both  \n",
      "1115  SLASH E.V. RANCH LLP      False    both  \n",
      "\n",
      "[2 rows x 155 columns]\n"
     ]
    }
   ],
   "source": [
    "# Part C: \n",
    "\n",
    "# merge jobs and debar_clean on \"name_clean_2\"\n",
    "jobs_debar_clean_nc2 = jobs.merge(debar_clean, how = \"left\", on = \"name_clean_2\", indicator = True)\n",
    "\n",
    "# print rows found in both dataframes\n",
    "both_found_rows = jobs_debar_clean_nc2[jobs_debar_clean_nc2[\"_merge\"] == \"both\"]\n",
    "print(both_found_rows)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 3. Optional extra credit 1: regex to separate companies from individuals (1 point)\n",
    "\n",
    "You notice some employers in `debar_clean` have both the name of the company and the name of individual, e.g.:\n",
    "    \n",
    "COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMSON (INDIVIDUAL)*\n",
    "\n",
    "Use the uppercase/cleaned `name_clean` in `debar_clean`\n",
    "\n",
    "A. Write a regex pattern that does the following:\n",
    "    - Captures the pattern that occurs before COMPANY if (COMPANY) is in string; so in example above, extracts COUNTY FAIR FARM \n",
    "    - Captures the pattern that occurs before INDIVIDUAL if (INDIVIDUAL) is also in string -- so in above, extracts ANDREW WILLIAMSON (so omit the \"and\")\n",
    "    \n",
    "B. Test the pattern on `pos_example` and `neg_example`-- make sure former returns a list (if using find.all) or match object (if using re.search) with the company name and individual name separated out; make sure latter returns empty\n",
    "    \n",
    "**Hints and resources**: for step A, you can either use re.search, re.match, or re.findall; don't worry about matching B&R Harvesting and Paul Cruz (Individual)\n",
    "\n",
    "- Same regex resources as above\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Positive Example (Company): ['COUNTY FAIR FARM']\n",
      "Positive Example (Individual): ['ANDREW WILLIAMSON']\n",
      "Negative Example (Company): []\n",
      "Negative Example (Individual): []\n"
     ]
    }
   ],
   "source": [
    "def extract_company_and_individual(text):\n",
    "    company_pattern = re.compile(r'(.+?)\\s*\\(COMPANY\\)')\n",
    "    individual_pattern = re.compile(r'\\(COMPANY\\)\\s+AND\\s+(.*?)\\s+\\(INDIVIDUAL\\)\\*')\n",
    "\n",
    "    company_match = re.findall(company_pattern, text)\n",
    "    individual_match = re.findall(individual_pattern, text)\n",
    "\n",
    "    return company_match, individual_match\n",
    "\n",
    "# test  function with pos and neg examples\n",
    "pos_example = \"COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMSON (INDIVIDUAL)*\"\n",
    "neg_example = \"CISCO PRODUCE INC\"\n",
    "\n",
    "# apply function to the examples\n",
    "pos_company, pos_individual = extract_company_and_individual(pos_example)\n",
    "neg_company, neg_individual = extract_company_and_individual(neg_example)\n",
    "\n",
    "print(\"Positive Example (Company):\", pos_company)\n",
    "print(\"Positive Example (Individual):\", pos_individual)\n",
    "print(\"Negative Example (Company):\", neg_company)\n",
    "print(\"Negative Example (Individual):\", neg_individual)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "C. Iterate over the `name_clean` column in debar and use regex to create two new columns in `debar_clean`:\n",
    "   - `co_name`: A column for company (full `name_clean` string if no match; pattern before COMPANY if one extracted)\n",
    "   - `ind_name`: A column for individual (full `name_clean` string if no match; pattern before INDIVIDUAL if one extracted)\n",
    " \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>co_name</th>\n",
       "      <th>ind_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>107</th>\n",
       "      <td>WALKER PLACE</td>\n",
       "      <td>WALKER PLACE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>108</th>\n",
       "      <td>COUNTY FAIR FARM</td>\n",
       "      <td>ANDREW WILLIAMSON</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>110</th>\n",
       "      <td>JESUS LEDESMA</td>\n",
       "      <td>JESUS LEDESMA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112</th>\n",
       "      <td>B &amp; R HARVESTING AND PAUL CRUZ (INDIVIDUAL)</td>\n",
       "      <td>B &amp; R HARVESTING AND PAUL CRUZ (INDIVIDUAL)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>113</th>\n",
       "      <td>DELIA ROJAS</td>\n",
       "      <td>DELIA ROJAS</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                         co_name  \\\n",
       "107                                 WALKER PLACE   \n",
       "108                             COUNTY FAIR FARM   \n",
       "110                                JESUS LEDESMA   \n",
       "112  B & R HARVESTING AND PAUL CRUZ (INDIVIDUAL)   \n",
       "113                                  DELIA ROJAS   \n",
       "\n",
       "                                        ind_name  \n",
       "107                                 WALKER PLACE  \n",
       "108                            ANDREW WILLIAMSON  \n",
       "110                                JESUS LEDESMA  \n",
       "112  B & R HARVESTING AND PAUL CRUZ (INDIVIDUAL)  \n",
       "113                                  DELIA ROJAS  "
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def extract_names(row):\n",
    "    company_pattern = re.compile(r'(.+?)\\s*\\(COMPANY\\)')\n",
    "    individual_pattern = re.compile(r'\\(COMPANY\\)\\s+AND\\s+(.*?)\\s+\\(INDIVIDUAL\\)\\*')\n",
    "    \n",
    "    company_match = company_pattern.search(row)\n",
    "    individual_match = individual_pattern.search(row)\n",
    "    \n",
    "    company_name = company_match.group(1) if company_match else row\n",
    "    individual_name = individual_match.group(1) if individual_match else row\n",
    "    \n",
    "    return pd.Series([company_name, individual_name])\n",
    "\n",
    "# apply function to the \"name_clean_2\" column and add results as new columns\n",
    "debar_clean[['co_name', 'ind_name']] = debar_clean['name_clean_2'].apply(extract_names)\n",
    "\n",
    "# display last couple rows of new columns\n",
    "debar_clean[['co_name', 'ind_name']].tail()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "   \n",
    "D. Print three columns for the rows in `debar_clean` containing the negative example and positive example described above (county fair farm and cisco produce):\n",
    "\n",
    "- `name_clean`\n",
    "- `co_name`\n",
    "- `ind_name`\n",
    "- `Violation`\n",
    "\n",
    "**Note**: as shown in the outcome there may be duplicates of the same company reflecting different violations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name_clean_2</th>\n",
       "      <th>co_name</th>\n",
       "      <th>ind_name</th>\n",
       "      <th>Violation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>CISCO PRODUCE INC</td>\n",
       "      <td>CISCO PRODUCE INC</td>\n",
       "      <td>CISCO PRODUCE INC</td>\n",
       "      <td>Failure to respond to audit (no response)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>CISCO PRODUCE INC</td>\n",
       "      <td>CISCO PRODUCE INC</td>\n",
       "      <td>CISCO PRODUCE INC</td>\n",
       "      <td>Impeding the Audit Process – Non- Response</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>108</th>\n",
       "      <td>COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...</td>\n",
       "      <td>COUNTY FAIR FARM</td>\n",
       "      <td>ANDREW WILLIAMSON</td>\n",
       "      <td>WHD Debarment</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                          name_clean_2            co_name  \\\n",
       "19                                   CISCO PRODUCE INC  CISCO PRODUCE INC   \n",
       "56                                   CISCO PRODUCE INC  CISCO PRODUCE INC   \n",
       "108  COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS...   COUNTY FAIR FARM   \n",
       "\n",
       "              ind_name                                   Violation  \n",
       "19   CISCO PRODUCE INC   Failure to respond to audit (no response)  \n",
       "56   CISCO PRODUCE INC  Impeding the Audit Process – Non- Response  \n",
       "108  ANDREW WILLIAMSON                               WHD Debarment  "
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pos_example = \"COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMSON (INDIVIDUAL)*\"\n",
    "neg_example = \"CISCO PRODUCE INC\"\n",
    "example_values = [pos_example, neg_example]\n",
    "\n",
    "selected_columns = debar_clean[debar_clean['name_clean_2'].isin(example_values)][[\"name_clean_2\", \"co_name\", \"ind_name\", \"Violation\"]]\n",
    "\n",
    "selected_columns"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 4. Optional extra credit 2 (up to 3 points)\n",
    "\n",
    "- For 1 point extra credit, create a visualization with 1+ of the existing fields in either the raw `jobs` or `debar` data. We'll be showing cool visualizations in class so use your imagination! Options could include visualizing between-state or over-time variation\n",
    "\n",
    "- For 3 points extra credit instead, geocode the employer addresses in `jobs` and plot the addresses of jobs as points overlaid on top of a map of Georgia \n",
    "    - **Note**: this extra credit involves Googling since we have not yet covered spatial data. \n",
    "        - For discussion of how to geocode addresses -> lat/long, see: https://www.natasshaselvaraj.com/a-step-by-step-guide-on-geocoding-in-python/ \n",
    "        - For discussion of plotting lat/long dots against a map, see this discussion of geopandas: https://towardsdatascience.com/plotting-maps-with-geopandas-428c97295a73\n",
    "    - Relevant columns include `EMPLOYER_ADDRESS_1` \n",
    "    - The geocoding might have a long runtime so feel free to implement it in a separate .py script that you submit alongside your notebook and to just read in the geocoded data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "unconverted data remains when parsing with format \"%m/%d/%y\": \"14\", at position 0. You might want to try:\n    - passing `format` if your strings have a consistent format;\n    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;\n    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[22], line 5\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;66;03m# Convert the 'date_strings' column to date objects\u001b[39;00m\n\u001b[1;32m      3\u001b[0m date_format \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m%\u001b[39m\u001b[38;5;124mm/\u001b[39m\u001b[38;5;132;01m%d\u001b[39;00m\u001b[38;5;124m/\u001b[39m\u001b[38;5;124m%\u001b[39m\u001b[38;5;124my\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[0;32m----> 5\u001b[0m debar[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mStart date\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mto_datetime(debar[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mStart date\u001b[39m\u001b[38;5;124m\"\u001b[39m], \u001b[38;5;28mformat\u001b[39m\u001b[38;5;241m=\u001b[39mdate_format)\u001b[38;5;241m.\u001b[39mdt\u001b[38;5;241m.\u001b[39mdate\n\u001b[1;32m      7\u001b[0m plot \u001b[38;5;241m=\u001b[39m (\n\u001b[1;32m      8\u001b[0m     ggplot(debar, aes(x\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCity, State\u001b[39m\u001b[38;5;124m'\u001b[39m)) \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m      9\u001b[0m     geom_bar() \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m     10\u001b[0m     theme(axis_text_x\u001b[38;5;241m=\u001b[39melement_text(angle\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m90\u001b[39m, hjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m))\n\u001b[1;32m     11\u001b[0m )\n\u001b[1;32m     13\u001b[0m plot\u001b[38;5;241m.\u001b[39msave(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mextracredit2.png\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[0;32m/opt/anaconda3/lib/python3.11/site-packages/pandas/core/tools/datetimes.py:1112\u001b[0m, in \u001b[0;36mto_datetime\u001b[0;34m(arg, errors, dayfirst, yearfirst, utc, format, exact, unit, infer_datetime_format, origin, cache)\u001b[0m\n\u001b[1;32m   1110\u001b[0m         result \u001b[38;5;241m=\u001b[39m arg\u001b[38;5;241m.\u001b[39mmap(cache_array)\n\u001b[1;32m   1111\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m-> 1112\u001b[0m         values \u001b[38;5;241m=\u001b[39m convert_listlike(arg\u001b[38;5;241m.\u001b[39m_values, \u001b[38;5;28mformat\u001b[39m)\n\u001b[1;32m   1113\u001b[0m         result \u001b[38;5;241m=\u001b[39m arg\u001b[38;5;241m.\u001b[39m_constructor(values, index\u001b[38;5;241m=\u001b[39marg\u001b[38;5;241m.\u001b[39mindex, name\u001b[38;5;241m=\u001b[39marg\u001b[38;5;241m.\u001b[39mname)\n\u001b[1;32m   1114\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(arg, (ABCDataFrame, abc\u001b[38;5;241m.\u001b[39mMutableMapping)):\n",
      "File \u001b[0;32m/opt/anaconda3/lib/python3.11/site-packages/pandas/core/tools/datetimes.py:488\u001b[0m, in \u001b[0;36m_convert_listlike_datetimes\u001b[0;34m(arg, format, name, utc, unit, errors, dayfirst, yearfirst, exact)\u001b[0m\n\u001b[1;32m    486\u001b[0m \u001b[38;5;66;03m# `format` could be inferred, or user didn't ask for mixed-format parsing.\u001b[39;00m\n\u001b[1;32m    487\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mformat\u001b[39m \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mformat\u001b[39m \u001b[38;5;241m!=\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmixed\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[0;32m--> 488\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m _array_strptime_with_fallback(arg, name, utc, \u001b[38;5;28mformat\u001b[39m, exact, errors)\n\u001b[1;32m    490\u001b[0m result, tz_parsed \u001b[38;5;241m=\u001b[39m objects_to_datetime64ns(\n\u001b[1;32m    491\u001b[0m     arg,\n\u001b[1;32m    492\u001b[0m     dayfirst\u001b[38;5;241m=\u001b[39mdayfirst,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    496\u001b[0m     allow_object\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m,\n\u001b[1;32m    497\u001b[0m )\n\u001b[1;32m    499\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m tz_parsed \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    500\u001b[0m     \u001b[38;5;66;03m# We can take a shortcut since the datetime64 numpy array\u001b[39;00m\n\u001b[1;32m    501\u001b[0m     \u001b[38;5;66;03m# is in UTC\u001b[39;00m\n",
      "File \u001b[0;32m/opt/anaconda3/lib/python3.11/site-packages/pandas/core/tools/datetimes.py:519\u001b[0m, in \u001b[0;36m_array_strptime_with_fallback\u001b[0;34m(arg, name, utc, fmt, exact, errors)\u001b[0m\n\u001b[1;32m    508\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_array_strptime_with_fallback\u001b[39m(\n\u001b[1;32m    509\u001b[0m     arg,\n\u001b[1;32m    510\u001b[0m     name,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    514\u001b[0m     errors: \u001b[38;5;28mstr\u001b[39m,\n\u001b[1;32m    515\u001b[0m ) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m Index:\n\u001b[1;32m    516\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m    517\u001b[0m \u001b[38;5;124;03m    Call array_strptime, with fallback behavior depending on 'errors'.\u001b[39;00m\n\u001b[1;32m    518\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[0;32m--> 519\u001b[0m     result, timezones \u001b[38;5;241m=\u001b[39m array_strptime(arg, fmt, exact\u001b[38;5;241m=\u001b[39mexact, errors\u001b[38;5;241m=\u001b[39merrors, utc\u001b[38;5;241m=\u001b[39mutc)\n\u001b[1;32m    520\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(tz \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;28;01mfor\u001b[39;00m tz \u001b[38;5;129;01min\u001b[39;00m timezones):\n\u001b[1;32m    521\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m _return_parsed_timezone_results(result, timezones, utc, name)\n",
      "File \u001b[0;32mstrptime.pyx:534\u001b[0m, in \u001b[0;36mpandas._libs.tslibs.strptime.array_strptime\u001b[0;34m()\u001b[0m\n",
      "File \u001b[0;32mstrptime.pyx:359\u001b[0m, in \u001b[0;36mpandas._libs.tslibs.strptime.array_strptime\u001b[0;34m()\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: unconverted data remains when parsing with format \"%m/%d/%y\": \"14\", at position 0. You might want to try:\n    - passing `format` if your strings have a consistent format;\n    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;\n    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this."
     ]
    }
   ],
   "source": [
    "# Convert the 'date_strings' column to date objects\n",
    "\n",
    "date_format = '%m/%d/%y'\n",
    "\n",
    "debar['Start date'] = pd.to_datetime(debar[\"Start date\"], format=date_format).dt.date\n",
    "\n",
    "plot = (\n",
    "    ggplot(debar, aes(x='City, State')) +\n",
    "    geom_bar() +\n",
    "    theme(axis_text_x=element_text(angle=90, hjust=1))\n",
    ")\n",
    "\n",
    "plot.save(\"extracredit2.png\")\n",
    "\n",
    "debar_clean"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
